Used config:
{'B': 1,
 'D_feat': 512,
 'D_inner': 256,
 'arch': 'ga',
 'config': 'config/bracs_config.yml',
 'data_dir': '/mnt/Xsky/zyl/dataset/bracs/roi_feats_x20',
 'dataset': 'bracs',
 'eval_only': False,
 'lr': 0.0001,
 'mask_drop': 0.6,
 'min_lr': 0,
 'n_class': 3,
 'n_masked_patch': 10,
 'n_shot': -1,
 'n_token': 5,
 'n_worker': 8,
 'pin_memory': False,
 'pretrain': 'natural_supervised',
 'seed': 1,
 'train_epoch': 50,
 'wandb_mode': 'online',
 'warmup_epoch': 0,
 'wd': 1e-05}
Epoch: [0]  [  0/389]  eta: 0:20:39  lr: 0.000100  sub_loss: 1.2962 (1.2962)  diff_loss: 0.9984 (0.9984)  slide_loss: 0.8097 (0.8097)  time: 3.1859  data: 1.9446  max mem: 165
Epoch: [0]  [100/389]  eta: 0:00:18  lr: 0.000100  sub_loss: 0.6534 (1.0268)  diff_loss: 0.9625 (0.9868)  slide_loss: 0.6099 (1.0520)  time: 0.0320  data: 0.0015  max mem: 199
Epoch: [0]  [200/389]  eta: 0:00:08  lr: 0.000100  sub_loss: 0.8390 (1.0276)  diff_loss: 0.3608 (0.7912)  slide_loss: 0.8200 (1.0221)  time: 0.0251  data: 0.0012  max mem: 206
Epoch: [0]  [300/389]  eta: 0:00:03  lr: 0.000100  sub_loss: 0.6032 (1.0010)  diff_loss: 0.2130 (0.6157)  slide_loss: 0.5183 (0.9830)  time: 0.0223  data: 0.0012  max mem: 210
Epoch: [0]  [388/389]  eta: 0:00:00  lr: 0.000100  sub_loss: 0.7847 (0.9861)  diff_loss: 0.1884 (0.5221)  slide_loss: 0.8086 (0.9657)  time: 0.0296  data: 0.0014  max mem: 242
Epoch: [0] Total time: 0:00:15 (0.0393 s / it)
Val  [ 0/62]  eta: 0:01:44  loss: 0.7293 (0.7293)  div_loss: -5.2082 (-5.2082)  acc1: 100.0000 (100.0000)  time: 1.6919  data: 1.6752  max mem: 242
Val  [61/62]  eta: 0:00:00  loss: 0.7512 (1.0323)  div_loss: -7.4840 (-7.3412)  acc1: 100.0000 (72.5806)  time: 0.0169  data: 0.0021  max mem: 242
Val Total time: 0:00:03 (0.0505 s / it)
* Acc@1 72.581 loss 1.032 auroc 0.767 f1_score 0.726
Test  [ 0/86]  eta: 0:02:47  loss: 2.1823 (2.1823)  div_loss: -7.3303 (-7.3303)  acc1: 0.0000 (0.0000)  time: 1.9510  data: 1.9278  max mem: 242
Test  [85/86]  eta: 0:00:00  loss: 0.7602 (1.1133)  div_loss: -7.4775 (-7.3485)  acc1: 100.0000 (52.3256)  time: 0.0162  data: 0.0021  max mem: 242
Test Total time: 0:00:03 (0.0440 s / it)
* Acc@1 52.326 loss 1.113 auroc 0.715 f1_score 0.523
Epoch: [1]  [  0/389]  eta: 0:13:18  lr: 0.000100  sub_loss: 2.2812 (2.2812)  diff_loss: 0.1796 (0.1796)  slide_loss: 2.1600 (2.1600)  time: 2.0536  data: 1.9941  max mem: 242
Epoch: [1]  [100/389]  eta: 0:00:14  lr: 0.000100  sub_loss: 0.6863 (0.9389)  diff_loss: 0.1472 (0.1681)  slide_loss: 0.6706 (0.8953)  time: 0.0277  data: 0.0014  max mem: 242
Epoch: [1]  [200/389]  eta: 0:00:07  lr: 0.000100  sub_loss: 0.7170 (0.9307)  diff_loss: 0.0871 (0.1426)  slide_loss: 0.6092 (0.8825)  time: 0.0249  data: 0.0013  max mem: 242
Epoch: [1]  [300/389]  eta: 0:00:03  lr: 0.000100  sub_loss: 0.7224 (0.9149)  diff_loss: 0.0580 (0.1218)  slide_loss: 0.6143 (0.8663)  time: 0.0255  data: 0.0012  max mem: 242
Epoch: [1]  [388/389]  eta: 0:00:00  lr: 0.000100  sub_loss: 0.7496 (0.9374)  diff_loss: 0.0402 (0.1061)  slide_loss: 0.8395 (0.8892)  time: 0.0358  data: 0.0014  max mem: 242
Epoch: [1] Total time: 0:00:14 (0.0370 s / it)
Val  [ 0/62]  eta: 0:02:02  loss: 0.5339 (0.5339)  div_loss: -4.9174 (-4.9174)  acc1: 100.0000 (100.0000)  time: 1.9769  data: 1.9672  max mem: 242
Val  [61/62]  eta: 0:00:00  loss: 0.8705 (0.9769)  div_loss: -7.0510 (-7.0427)  acc1: 0.0000 (50.0000)  time: 0.0156  data: 0.0016  max mem: 242
Val Total time: 0:00:03 (0.0538 s / it)
* Acc@1 50.000 loss 0.977 auroc 0.823 f1_score 0.500
Test  [ 0/86]  eta: 0:02:59  loss: 2.1476 (2.1476)  div_loss: -7.0443 (-7.0443)  acc1: 0.0000 (0.0000)  time: 2.0832  data: 2.0660  max mem: 242
Test  [85/86]  eta: 0:00:00  loss: 0.8218 (1.1332)  div_loss: -7.0557 (-7.0329)  acc1: 0.0000 (45.3488)  time: 0.0132  data: 0.0023  max mem: 242
Test Total time: 0:00:03 (0.0437 s / it)
* Acc@1 45.349 loss 1.133 auroc 0.702 f1_score 0.453
Epoch: [2]  [  0/389]  eta: 0:13:09  lr: 0.000100  sub_loss: 0.9234 (0.9234)  diff_loss: 0.0372 (0.0372)  slide_loss: 0.7420 (0.7420)  time: 2.0302  data: 1.9704  max mem: 242
Epoch: [2]  [100/389]  eta: 0:00:14  lr: 0.000099  sub_loss: 0.7074 (0.9101)  diff_loss: 0.0305 (0.0464)  slide_loss: 0.7809 (0.8364)  time: 0.0285  data: 0.0014  max mem: 242
Epoch: [2]  [200/389]  eta: 0:00:07  lr: 0.000099  sub_loss: 0.7999 (0.9173)  diff_loss: 0.0259 (0.0445)  slide_loss: 0.7022 (0.8478)  time: 0.0231  data: 0.0012  max mem: 242
Epoch: [2]  [300/389]  eta: 0:00:03  lr: 0.000099  sub_loss: 0.6578 (0.8921)  diff_loss: 0.0256 (0.0432)  slide_loss: 0.4033 (0.8211)  time: 0.0279  data: 0.0013  max mem: 242
Epoch: [2]  [388/389]  eta: 0:00:00  lr: 0.000099  sub_loss: 0.6713 (0.8839)  diff_loss: 0.0236 (0.0433)  slide_loss: 0.5857 (0.8162)  time: 0.0350  data: 0.0014  max mem: 242
Epoch: [2] Total time: 0:00:14 (0.0373 s / it)
Val  [ 0/62]  eta: 0:02:08  loss: 0.9077 (0.9077)  div_loss: -4.6553 (-4.6553)  acc1: 0.0000 (0.0000)  time: 2.0769  data: 2.0657  max mem: 242
Val  [61/62]  eta: 0:00:00  loss: 0.6508 (0.8558)  div_loss: -6.4941 (-6.6277)  acc1: 100.0000 (67.7419)  time: 0.0133  data: 0.0015  max mem: 242
Val Total time: 0:00:03 (0.0640 s / it)
* Acc@1 67.742 loss 0.856 auroc 0.819 f1_score 0.677
Test  [ 0/86]  eta: 0:02:24  loss: 1.6352 (1.6352)  div_loss: -6.5919 (-6.5919)  acc1: 0.0000 (0.0000)  time: 1.6750  data: 1.6569  max mem: 242
Test  [85/86]  eta: 0:00:00  loss: 0.7749 (0.9704)  div_loss: -6.6228 (-6.6492)  acc1: 0.0000 (54.6512)  time: 0.0135  data: 0.0013  max mem: 242
Test Total time: 0:00:03 (0.0378 s / it)
* Acc@1 54.651 loss 0.970 auroc 0.718 f1_score 0.547
Epoch: [3]  [  0/389]  eta: 0:12:21  lr: 0.000099  sub_loss: 0.3842 (0.3842)  diff_loss: 0.0396 (0.0396)  slide_loss: 0.2736 (0.2736)  time: 1.9066  data: 1.8469  max mem: 242
Epoch: [3]  [100/389]  eta: 0:00:13  lr: 0.000099  sub_loss: 0.6703 (0.9120)  diff_loss: 0.0186 (0.0285)  slide_loss: 0.6308 (0.8504)  time: 0.0280  data: 0.0013  max mem: 242
Epoch: [3]  [200/389]  eta: 0:00:07  lr: 0.000099  sub_loss: 0.6344 (0.8640)  diff_loss: 0.0171 (0.0310)  slide_loss: 0.5347 (0.7904)  time: 0.0284  data: 0.0013  max mem: 242
Epoch: [3]  [300/389]  eta: 0:00:03  lr: 0.000099  sub_loss: 0.5573 (0.8530)  diff_loss: 0.0210 (0.0299)  slide_loss: 0.3538 (0.7771)  time: 0.0308  data: 0.0013  max mem: 242
Epoch: [3]  [388/389]  eta: 0:00:00  lr: 0.000098  sub_loss: 0.6464 (0.8515)  diff_loss: 0.0204 (0.0300)  slide_loss: 0.5411 (0.7777)  time: 0.0284  data: 0.0015  max mem: 242
Epoch: [3] Total time: 0:00:13 (0.0358 s / it)
Val  [ 0/62]  eta: 0:02:02  loss: 0.9732 (0.9732)  div_loss: -4.6617 (-4.6617)  acc1: 0.0000 (0.0000)  time: 1.9691  data: 1.9583  max mem: 242
Val  [61/62]  eta: 0:00:00  loss: 0.5316 (0.8540)  div_loss: -6.3812 (-6.5062)  acc1: 100.0000 (69.3548)  time: 0.0133  data: 0.0015  max mem: 242
Val Total time: 0:00:03 (0.0588 s / it)
* Acc@1 69.355 loss 0.854 auroc 0.807 f1_score 0.694
Test  [ 0/86]  eta: 0:02:40  loss: 2.0155 (2.0155)  div_loss: -6.4348 (-6.4348)  acc1: 0.0000 (0.0000)  time: 1.8635  data: 1.8455  max mem: 242
Test  [85/86]  eta: 0:00:00  loss: 0.6196 (0.9781)  div_loss: -6.5040 (-6.5369)  acc1: 0.0000 (55.8140)  time: 0.0126  data: 0.0013  max mem: 242
Test Total time: 0:00:03 (0.0412 s / it)
* Acc@1 55.814 loss 0.978 auroc 0.737 f1_score 0.558
Epoch: [4]  [  0/389]  eta: 0:12:00  lr: 0.000098  sub_loss: 1.8613 (1.8613)  diff_loss: 0.0110 (0.0110)  slide_loss: 1.8046 (1.8046)  time: 1.8525  data: 1.8207  max mem: 242
Epoch: [4]  [100/389]  eta: 0:00:13  lr: 0.000098  sub_loss: 0.5552 (0.8325)  diff_loss: 0.0228 (0.0271)  slide_loss: 0.3387 (0.7580)  time: 0.0252  data: 0.0012  max mem: 242
Epoch: [4]  [200/389]  eta: 0:00:07  lr: 0.000098  sub_loss: 0.4667 (0.7812)  diff_loss: 0.0193 (0.0277)  slide_loss: 0.2556 (0.7071)  time: 0.0279  data: 0.0013  max mem: 242
Epoch: [4]  [300/389]  eta: 0:00:03  lr: 0.000098  sub_loss: 0.6772 (0.7941)  diff_loss: 0.0226 (0.0283)  slide_loss: 0.4608 (0.7151)  time: 0.0248  data: 0.0013  max mem: 242
Epoch: [4]  [388/389]  eta: 0:00:00  lr: 0.000098  sub_loss: 0.8557 (0.8070)  diff_loss: 0.0120 (0.0272)  slide_loss: 0.9721 (0.7275)  time: 0.0317  data: 0.0012  max mem: 242
Epoch: [4] Total time: 0:00:13 (0.0353 s / it)
Val  [ 0/62]  eta: 0:02:01  loss: 1.2174 (1.2174)  div_loss: -4.6363 (-4.6363)  acc1: 0.0000 (0.0000)  time: 1.9565  data: 1.9450  max mem: 242
Val  [61/62]  eta: 0:00:00  loss: 0.5911 (0.8128)  div_loss: -6.1617 (-6.2766)  acc1: 100.0000 (59.6774)  time: 0.0132  data: 0.0014  max mem: 242
Val Total time: 0:00:03 (0.0579 s / it)
* Acc@1 59.677 loss 0.813 auroc 0.801 f1_score 0.597
Test  [ 0/86]  eta: 0:02:38  loss: 1.2596 (1.2596)  div_loss: -6.2353 (-6.2353)  acc1: 0.0000 (0.0000)  time: 1.8416  data: 1.8128  max mem: 242
Test  [85/86]  eta: 0:00:00  loss: 0.8082 (0.9140)  div_loss: -6.1880 (-6.3227)  acc1: 0.0000 (46.5116)  time: 0.0171  data: 0.0016  max mem: 242
Test Total time: 0:00:03 (0.0427 s / it)
* Acc@1 46.512 loss 0.914 auroc 0.736 f1_score 0.465
Epoch: [5]  [  0/389]  eta: 0:13:10  lr: 0.000098  sub_loss: 1.2720 (1.2720)  diff_loss: 0.0173 (0.0173)  slide_loss: 1.8986 (1.8986)  time: 2.0310  data: 1.9819  max mem: 242
Epoch: [5]  [100/389]  eta: 0:00:14  lr: 0.000097  sub_loss: 0.6273 (0.8093)  diff_loss: 0.0141 (0.0253)  slide_loss: 0.4868 (0.7417)  time: 0.0248  data: 0.0013  max mem: 242
Epoch: [5]  [200/389]  eta: 0:00:07  lr: 0.000097  sub_loss: 0.3111 (0.7783)  diff_loss: 0.0425 (0.0319)  slide_loss: 0.2061 (0.6928)  time: 0.0310  data: 0.0018  max mem: 242
Epoch: [5]  [300/389]  eta: 0:00:03  lr: 0.000097  sub_loss: 0.5473 (0.7781)  diff_loss: 0.0141 (0.0296)  slide_loss: 0.3690 (0.6880)  time: 0.0372  data: 0.0020  max mem: 242
Epoch: [5]  [388/389]  eta: 0:00:00  lr: 0.000096  sub_loss: 0.6058 (0.7739)  diff_loss: 0.0152 (0.0279)  slide_loss: 0.5546 (0.6818)  time: 0.0255  data: 0.0012  max mem: 242
Epoch: [5] Total time: 0:00:13 (0.0352 s / it)
Val  [ 0/62]  eta: 0:02:00  loss: 1.5888 (1.5888)  div_loss: -4.6044 (-4.6044)  acc1: 0.0000 (0.0000)  time: 1.9447  data: 1.9264  max mem: 242
Val  [61/62]  eta: 0:00:00  loss: 0.4432 (0.9598)  div_loss: -6.0769 (-6.2265)  acc1: 100.0000 (59.6774)  time: 0.0154  data: 0.0016  max mem: 242
Val Total time: 0:00:03 (0.0555 s / it)
* Acc@1 59.677 loss 0.960 auroc 0.770 f1_score 0.597
Test  [ 0/86]  eta: 0:02:50  loss: 2.1582 (2.1582)  div_loss: -6.2333 (-6.2333)  acc1: 0.0000 (0.0000)  time: 1.9829  data: 1.9570  max mem: 242
Test  [85/86]  eta: 0:00:00  loss: 0.7701 (0.9985)  div_loss: -6.1453 (-6.2473)  acc1: 0.0000 (58.1395)  time: 0.0150  data: 0.0015  max mem: 242
Test Total time: 0:00:03 (0.0435 s / it)
* Acc@1 58.140 loss 0.998 auroc 0.753 f1_score 0.581
Epoch: [6]  [  0/389]  eta: 0:11:25  lr: 0.000096  sub_loss: 0.3115 (0.3115)  diff_loss: 0.0104 (0.0104)  slide_loss: 0.1282 (0.1282)  time: 1.7621  data: 1.7167  max mem: 242
Epoch: [6]  [100/389]  eta: 0:00:16  lr: 0.000096  sub_loss: 0.3545 (0.6729)  diff_loss: 0.0190 (0.0286)  slide_loss: 0.1372 (0.5541)  time: 0.0263  data: 0.0013  max mem: 242
Epoch: [6]  [200/389]  eta: 0:00:07  lr: 0.000096  sub_loss: 0.5380 (0.7352)  diff_loss: 0.0182 (0.0268)  slide_loss: 0.3968 (0.6433)  time: 0.0265  data: 0.0013  max mem: 242
Epoch: [6]  [300/389]  eta: 0:00:03  lr: 0.000096  sub_loss: 0.5268 (0.7351)  diff_loss: 0.0115 (0.0262)  slide_loss: 0.3142 (0.6385)  time: 0.0343  data: 0.0015  max mem: 242
Epoch: [6]  [388/389]  eta: 0:00:00  lr: 0.000095  sub_loss: 0.6528 (0.7391)  diff_loss: 0.0163 (0.0243)  slide_loss: 0.3476 (0.6447)  time: 0.0361  data: 0.0017  max mem: 242
Epoch: [6] Total time: 0:00:14 (0.0382 s / it)
Val  [ 0/62]  eta: 0:02:06  loss: 0.7887 (0.7887)  div_loss: -4.6126 (-4.6126)  acc1: 100.0000 (100.0000)  time: 2.0417  data: 2.0324  max mem: 242
Val  [61/62]  eta: 0:00:00  loss: 0.3906 (0.7657)  div_loss: -6.0524 (-6.1243)  acc1: 100.0000 (67.7419)  time: 0.0159  data: 0.0023  max mem: 242
Val Total time: 0:00:03 (0.0566 s / it)
* Acc@1 67.742 loss 0.766 auroc 0.797 f1_score 0.677
Test  [ 0/86]  eta: 0:02:27  loss: 1.6356 (1.6356)  div_loss: -6.0707 (-6.0707)  acc1: 0.0000 (0.0000)  time: 1.7113  data: 1.6943  max mem: 242
Test  [85/86]  eta: 0:00:00  loss: 0.7484 (0.9129)  div_loss: -6.0089 (-6.1559)  acc1: 0.0000 (55.8140)  time: 0.0151  data: 0.0015  max mem: 242
Test Total time: 0:00:03 (0.0428 s / it)
* Acc@1 55.814 loss 0.913 auroc 0.752 f1_score 0.558
Epoch: [7]  [  0/389]  eta: 0:10:12  lr: 0.000095  sub_loss: 0.2679 (0.2679)  diff_loss: 0.0105 (0.0105)  slide_loss: 0.2025 (0.2025)  time: 1.5746  data: 1.5231  max mem: 242
Epoch: [7]  [100/389]  eta: 0:00:14  lr: 0.000095  sub_loss: 0.5961 (0.8395)  diff_loss: 0.0110 (0.0212)  slide_loss: 0.5224 (0.7450)  time: 0.0303  data: 0.0014  max mem: 242
Epoch: [7]  [200/389]  eta: 0:00:07  lr: 0.000095  sub_loss: 0.3846 (0.7690)  diff_loss: 0.0139 (0.0217)  slide_loss: 0.2695 (0.6775)  time: 0.0376  data: 0.0018  max mem: 242
Epoch: [7]  [300/389]  eta: 0:00:03  lr: 0.000094  sub_loss: 0.4646 (0.7397)  diff_loss: 0.0153 (0.0211)  slide_loss: 0.3643 (0.6362)  time: 0.0367  data: 0.0019  max mem: 242
Epoch: [7]  [388/389]  eta: 0:00:00  lr: 0.000094  sub_loss: 0.4759 (0.7285)  diff_loss: 0.0118 (0.0235)  slide_loss: 0.2409 (0.6235)  time: 0.0249  data: 0.0013  max mem: 242
Epoch: [7] Total time: 0:00:14 (0.0370 s / it)
Val  [ 0/62]  eta: 0:01:46  loss: 0.7184 (0.7184)  div_loss: -4.6623 (-4.6623)  acc1: 100.0000 (100.0000)  time: 1.7195  data: 1.6728  max mem: 242
Val  [61/62]  eta: 0:00:00  loss: 0.3337 (0.8877)  div_loss: -6.0386 (-6.0896)  acc1: 100.0000 (69.3548)  time: 0.0171  data: 0.0017  max mem: 242
Val Total time: 0:00:03 (0.0507 s / it)
* Acc@1 69.355 loss 0.888 auroc 0.795 f1_score 0.694
Test  [ 0/86]  eta: 0:02:22  loss: 2.5970 (2.5970)  div_loss: -5.8322 (-5.8322)  acc1: 0.0000 (0.0000)  time: 1.6520  data: 1.6289  max mem: 242
Test  [85/86]  eta: 0:00:00  loss: 0.3633 (1.0344)  div_loss: -5.9870 (-6.0980)  acc1: 0.0000 (56.9767)  time: 0.0160  data: 0.0018  max mem: 242
Test Total time: 0:00:03 (0.0417 s / it)
* Acc@1 56.977 loss 1.034 auroc 0.753 f1_score 0.570
Epoch: [8]  [  0/389]  eta: 0:11:39  lr: 0.000094  sub_loss: 2.3378 (2.3378)  diff_loss: 0.0540 (0.0540)  slide_loss: 3.0488 (3.0488)  time: 1.7973  data: 1.7662  max mem: 242
Epoch: [8]  [100/389]  eta: 0:00:15  lr: 0.000093  sub_loss: 0.3845 (0.7498)  diff_loss: 0.0133 (0.0282)  slide_loss: 0.2294 (0.6642)  time: 0.0310  data: 0.0015  max mem: 242
Epoch: [8]  [200/389]  eta: 0:00:07  lr: 0.000093  sub_loss: 0.4250 (0.6751)  diff_loss: 0.0157 (0.0262)  slide_loss: 0.1786 (0.5583)  time: 0.0329  data: 0.0014  max mem: 242
Epoch: [8]  [300/389]  eta: 0:00:03  lr: 0.000093  sub_loss: 0.4038 (0.6787)  diff_loss: 0.0224 (0.0257)  slide_loss: 0.2163 (0.5642)  time: 0.0246  data: 0.0012  max mem: 242
Epoch: [8]  [388/389]  eta: 0:00:00  lr: 0.000092  sub_loss: 0.5645 (0.7087)  diff_loss: 0.0193 (0.0247)  slide_loss: 0.3016 (0.5980)  time: 0.0239  data: 0.0013  max mem: 242
Epoch: [8] Total time: 0:00:14 (0.0370 s / it)
Val  [ 0/62]  eta: 0:01:43  loss: 1.0843 (1.0843)  div_loss: -4.5072 (-4.5072)  acc1: 0.0000 (0.0000)  time: 1.6639  data: 1.6396  max mem: 242
Val  [61/62]  eta: 0:00:00  loss: 0.3018 (0.8079)  div_loss: -6.1355 (-6.1669)  acc1: 100.0000 (64.5161)  time: 0.0171  data: 0.0017  max mem: 242
Val Total time: 0:00:03 (0.0508 s / it)
* Acc@1 64.516 loss 0.808 auroc 0.773 f1_score 0.645
Test  [ 0/86]  eta: 0:02:54  loss: 1.6624 (1.6624)  div_loss: -6.1983 (-6.1983)  acc1: 0.0000 (0.0000)  time: 2.0253  data: 2.0008  max mem: 242
Test  [85/86]  eta: 0:00:00  loss: 0.5832 (0.9017)  div_loss: -6.0852 (-6.1894)  acc1: 0.0000 (56.9767)  time: 0.0198  data: 0.0025  max mem: 242
Test Total time: 0:00:04 (0.0492 s / it)
* Acc@1 56.977 loss 0.902 auroc 0.755 f1_score 0.570
Epoch: [9]  [  0/389]  eta: 0:15:16  lr: 0.000092  sub_loss: 0.2170 (0.2170)  diff_loss: 0.0387 (0.0387)  slide_loss: 0.0713 (0.0713)  time: 2.3553  data: 2.2963  max mem: 242
Epoch: [9]  [100/389]  eta: 0:00:18  lr: 0.000092  sub_loss: 0.3349 (0.6438)  diff_loss: 0.0124 (0.0247)  slide_loss: 0.3171 (0.5265)  time: 0.0430  data: 0.0031  max mem: 242
Epoch: [9]  [200/389]  eta: 0:00:09  lr: 0.000091  sub_loss: 0.5894 (0.7028)  diff_loss: 0.0145 (0.0245)  slide_loss: 0.4503 (0.5892)  time: 0.0253  data: 0.0013  max mem: 242
Epoch: [9]  [300/389]  eta: 0:00:03  lr: 0.000091  sub_loss: 0.7830 (0.7098)  diff_loss: 0.0136 (0.0249)  slide_loss: 0.6580 (0.6014)  time: 0.0273  data: 0.0014  max mem: 242
Epoch: [9]  [388/389]  eta: 0:00:00  lr: 0.000090  sub_loss: 0.4092 (0.6933)  diff_loss: 0.0136 (0.0239)  slide_loss: 0.2189 (0.5909)  time: 0.0300  data: 0.0022  max mem: 242
Epoch: [9] Total time: 0:00:16 (0.0424 s / it)
Val  [ 0/62]  eta: 0:01:53  loss: 0.9220 (0.9220)  div_loss: -4.5590 (-4.5590)  acc1: 0.0000 (0.0000)  time: 1.8304  data: 1.8129  max mem: 242
Val  [61/62]  eta: 0:00:00  loss: 0.2149 (0.9028)  div_loss: -6.0625 (-6.0770)  acc1: 100.0000 (66.1290)  time: 0.0206  data: 0.0020  max mem: 242
Val Total time: 0:00:04 (0.0672 s / it)
* Acc@1 66.129 loss 0.903 auroc 0.770 f1_score 0.661
Test  [ 0/86]  eta: 0:03:04  loss: 2.4939 (2.4939)  div_loss: -5.8457 (-5.8457)  acc1: 0.0000 (0.0000)  time: 2.1499  data: 2.1234  max mem: 242
Test  [85/86]  eta: 0:00:00  loss: 0.4107 (1.0073)  div_loss: -5.9865 (-6.0806)  acc1: 0.0000 (56.9767)  time: 0.0203  data: 0.0019  max mem: 242
Test Total time: 0:00:04 (0.0515 s / it)
* Acc@1 56.977 loss 1.007 auroc 0.756 f1_score 0.570
Epoch: [10]  [  0/389]  eta: 0:15:29  lr: 0.000090  sub_loss: 0.3861 (0.3861)  diff_loss: 0.0103 (0.0103)  slide_loss: 0.2142 (0.2142)  time: 2.3901  data: 2.3309  max mem: 242
Epoch: [10]  [100/389]  eta: 0:00:17  lr: 0.000090  sub_loss: 0.3724 (0.6757)  diff_loss: 0.0154 (0.0239)  slide_loss: 0.2602 (0.5655)  time: 0.0399  data: 0.0019  max mem: 242
Epoch: [10]  [200/389]  eta: 0:00:09  lr: 0.000089  sub_loss: 0.7089 (0.7164)  diff_loss: 0.0167 (0.0241)  slide_loss: 0.6150 (0.6139)  time: 0.0376  data: 0.0019  max mem: 242
Epoch: [10]  [300/389]  eta: 0:00:03  lr: 0.000089  sub_loss: 0.4149 (0.6949)  diff_loss: 0.0132 (0.0236)  slide_loss: 0.3268 (0.5887)  time: 0.0396  data: 0.0018  max mem: 242
Epoch: [10]  [388/389]  eta: 0:00:00  lr: 0.000089  sub_loss: 0.4250 (0.6854)  diff_loss: 0.0204 (0.0228)  slide_loss: 0.1661 (0.5785)  time: 0.0387  data: 0.0016  max mem: 242
Epoch: [10] Total time: 0:00:16 (0.0421 s / it)
Val  [ 0/62]  eta: 0:01:57  loss: 0.9654 (0.9654)  div_loss: -4.5116 (-4.5116)  acc1: 0.0000 (0.0000)  time: 1.8990  data: 1.8872  max mem: 242
Val  [61/62]  eta: 0:00:00  loss: 0.1875 (0.9421)  div_loss: -5.9981 (-5.9998)  acc1: 100.0000 (62.9032)  time: 0.0170  data: 0.0015  max mem: 242
Val Total time: 0:00:03 (0.0610 s / it)
* Acc@1 62.903 loss 0.942 auroc 0.771 f1_score 0.629
Test  [ 0/86]  eta: 0:02:51  loss: 2.6244 (2.6244)  div_loss: -5.9736 (-5.9736)  acc1: 0.0000 (0.0000)  time: 1.9907  data: 1.9627  max mem: 242
Test  [85/86]  eta: 0:00:00  loss: 0.3548 (1.0326)  div_loss: -5.8713 (-6.0005)  acc1: 0.0000 (59.3023)  time: 0.0197  data: 0.0018  max mem: 242
Test Total time: 0:00:04 (0.0496 s / it)
* Acc@1 59.302 loss 1.033 auroc 0.761 f1_score 0.593
Epoch: [11]  [  0/389]  eta: 0:13:01  lr: 0.000089  sub_loss: 0.0584 (0.0584)  diff_loss: 0.1948 (0.1948)  slide_loss: 0.0091 (0.0091)  time: 2.0093  data: 1.9678  max mem: 242
Epoch: [11]  [100/389]  eta: 0:00:17  lr: 0.000088  sub_loss: 0.4010 (0.6808)  diff_loss: 0.0158 (0.0215)  slide_loss: 0.2190 (0.5775)  time: 0.0365  data: 0.0017  max mem: 242
Epoch: [11]  [200/389]  eta: 0:00:09  lr: 0.000087  sub_loss: 0.6218 (0.7222)  diff_loss: 0.0128 (0.0206)  slide_loss: 0.4276 (0.6295)  time: 0.0392  data: 0.0019  max mem: 242
Epoch: [11]  [300/389]  eta: 0:00:04  lr: 0.000087  sub_loss: 0.4320 (0.7230)  diff_loss: 0.0117 (0.0198)  slide_loss: 0.2384 (0.6201)  time: 0.0394  data: 0.0025  max mem: 242
Epoch: [11]  [388/389]  eta: 0:00:00  lr: 0.000086  sub_loss: 0.3650 (0.6761)  diff_loss: 0.0147 (0.0219)  slide_loss: 0.2001 (0.5691)  time: 0.0314  data: 0.0013  max mem: 242
Epoch: [11] Total time: 0:00:17 (0.0448 s / it)
Val  [ 0/62]  eta: 0:02:01  loss: 0.2529 (0.2529)  div_loss: -5.0228 (-5.0228)  acc1: 100.0000 (100.0000)  time: 1.9662  data: 1.9520  max mem: 242
Val  [61/62]  eta: 0:00:00  loss: 0.1951 (0.8240)  div_loss: -6.1452 (-6.1436)  acc1: 100.0000 (69.3548)  time: 0.0137  data: 0.0016  max mem: 242
Val Total time: 0:00:03 (0.0613 s / it)
* Acc@1 69.355 loss 0.824 auroc 0.789 f1_score 0.694
Test  [ 0/86]  eta: 0:02:38  loss: 1.6179 (1.6179)  div_loss: -6.2909 (-6.2909)  acc1: 0.0000 (0.0000)  time: 1.8428  data: 1.8157  max mem: 242
Test  [85/86]  eta: 0:00:00  loss: 0.6680 (0.9807)  div_loss: -5.9378 (-6.1469)  acc1: 100.0000 (59.3023)  time: 0.0177  data: 0.0015  max mem: 242
Test Total time: 0:00:03 (0.0456 s / it)
* Acc@1 59.302 loss 0.981 auroc 0.758 f1_score 0.593
Epoch: [12]  [  0/389]  eta: 0:11:30  lr: 0.000086  sub_loss: 0.0840 (0.0840)  diff_loss: 0.0605 (0.0605)  slide_loss: 0.0141 (0.0141)  time: 1.7748  data: 1.6908  max mem: 242
Epoch: [12]  [100/389]  eta: 0:00:15  lr: 0.000086  sub_loss: 0.4214 (0.7052)  diff_loss: 0.0149 (0.0220)  slide_loss: 0.2458 (0.5992)  time: 0.0342  data: 0.0020  max mem: 242
Epoch: [12]  [200/389]  eta: 0:00:08  lr: 0.000085  sub_loss: 0.5814 (0.7055)  diff_loss: 0.0193 (0.0243)  slide_loss: 0.3446 (0.5876)  time: 0.0371  data: 0.0020  max mem: 242
Epoch: [12]  [300/389]  eta: 0:00:03  lr: 0.000085  sub_loss: 0.3671 (0.6597)  diff_loss: 0.0165 (0.0239)  slide_loss: 0.1493 (0.5509)  time: 0.0274  data: 0.0014  max mem: 242
Epoch: [12]  [388/389]  eta: 0:00:00  lr: 0.000084  sub_loss: 0.4051 (0.6603)  diff_loss: 0.0132 (0.0233)  slide_loss: 0.1978 (0.5525)  time: 0.0350  data: 0.0014  max mem: 242
Epoch: [12] Total time: 0:00:16 (0.0429 s / it)
Val  [ 0/62]  eta: 0:01:50  loss: 1.5939 (1.5939)  div_loss: -4.3424 (-4.3424)  acc1: 0.0000 (0.0000)  time: 1.7857  data: 1.7643  max mem: 242
Val  [61/62]  eta: 0:00:00  loss: 0.2470 (1.0397)  div_loss: -5.7016 (-5.7934)  acc1: 100.0000 (61.2903)  time: 0.0124  data: 0.0012  max mem: 242
Val Total time: 0:00:03 (0.0570 s / it)
* Acc@1 61.290 loss 1.040 auroc 0.762 f1_score 0.613
Test  [ 0/86]  eta: 0:02:20  loss: 3.0535 (3.0535)  div_loss: -5.5924 (-5.5924)  acc1: 0.0000 (0.0000)  time: 1.6367  data: 1.5971  max mem: 242
Test  [85/86]  eta: 0:00:00  loss: 0.6453 (1.0842)  div_loss: -5.7900 (-5.7789)  acc1: 0.0000 (56.9767)  time: 0.0185  data: 0.0023  max mem: 242
Test Total time: 0:00:03 (0.0451 s / it)
* Acc@1 56.977 loss 1.084 auroc 0.749 f1_score 0.570
Epoch: [13]  [  0/389]  eta: 0:13:00  lr: 0.000084  sub_loss: 0.7818 (0.7818)  diff_loss: 0.0079 (0.0079)  slide_loss: 0.7586 (0.7586)  time: 2.0070  data: 1.9717  max mem: 242
Epoch: [13]  [100/389]  eta: 0:00:17  lr: 0.000084  sub_loss: 0.3806 (0.6922)  diff_loss: 0.0163 (0.0185)  slide_loss: 0.2030 (0.5901)  time: 0.0423  data: 0.0026  max mem: 242
Epoch: [13]  [200/389]  eta: 0:00:09  lr: 0.000083  sub_loss: 0.3814 (0.6643)  diff_loss: 0.0164 (0.0204)  slide_loss: 0.1540 (0.5490)  time: 0.0357  data: 0.0020  max mem: 242
Epoch: [13]  [300/389]  eta: 0:00:04  lr: 0.000082  sub_loss: 0.2687 (0.6503)  diff_loss: 0.0135 (0.0211)  slide_loss: 0.1250 (0.5397)  time: 0.0310  data: 0.0015  max mem: 242
Epoch: [13]  [388/389]  eta: 0:00:00  lr: 0.000082  sub_loss: 0.4839 (0.6539)  diff_loss: 0.0143 (0.0214)  slide_loss: 0.4832 (0.5371)  time: 0.0283  data: 0.0013  max mem: 242
Epoch: [13] Total time: 0:00:16 (0.0432 s / it)
Val  [ 0/62]  eta: 0:01:45  loss: 0.6103 (0.6103)  div_loss: -4.4199 (-4.4199)  acc1: 100.0000 (100.0000)  time: 1.7047  data: 1.6803  max mem: 242
Val  [61/62]  eta: 0:00:00  loss: 0.4688 (0.7028)  div_loss: -5.6521 (-5.8084)  acc1: 100.0000 (69.3548)  time: 0.0183  data: 0.0021  max mem: 242
Val Total time: 0:00:03 (0.0605 s / it)
* Acc@1 69.355 loss 0.703 auroc 0.805 f1_score 0.694
Test  [ 0/86]  eta: 0:03:26  loss: 1.5606 (1.5606)  div_loss: -5.4748 (-5.4748)  acc1: 0.0000 (0.0000)  time: 2.4031  data: 2.3768  max mem: 242
Test  [85/86]  eta: 0:00:00  loss: 0.8366 (0.9122)  div_loss: -5.7630 (-5.7923)  acc1: 0.0000 (55.8140)  time: 0.0177  data: 0.0016  max mem: 242
Test Total time: 0:00:04 (0.0498 s / it)
* Acc@1 55.814 loss 0.912 auroc 0.744 f1_score 0.558
Epoch: [14]  [  0/389]  eta: 0:13:45  lr: 0.000082  sub_loss: 1.1470 (1.1470)  diff_loss: 0.0120 (0.0120)  slide_loss: 1.7128 (1.7128)  time: 2.1217  data: 2.0787  max mem: 242
Epoch: [14]  [100/389]  eta: 0:00:18  lr: 0.000081  sub_loss: 0.3212 (0.6059)  diff_loss: 0.0138 (0.0207)  slide_loss: 0.1772 (0.5060)  time: 0.0363  data: 0.0018  max mem: 242
Epoch: [14]  [200/389]  eta: 0:00:09  lr: 0.000081  sub_loss: 0.5481 (0.6597)  diff_loss: 0.0145 (0.0230)  slide_loss: 0.3855 (0.5489)  time: 0.0366  data: 0.0020  max mem: 242
Epoch: [14]  [300/389]  eta: 0:00:04  lr: 0.000080  sub_loss: 0.3491 (0.6471)  diff_loss: 0.0126 (0.0220)  slide_loss: 0.1798 (0.5373)  time: 0.0431  data: 0.0024  max mem: 242
Epoch: [14]  [388/389]  eta: 0:00:00  lr: 0.000079  sub_loss: 0.3599 (0.6449)  diff_loss: 0.0123 (0.0223)  slide_loss: 0.2533 (0.5391)  time: 0.0462  data: 0.0026  max mem: 242
Epoch: [14] Total time: 0:00:17 (0.0460 s / it)
Val  [ 0/62]  eta: 0:01:49  loss: 1.3169 (1.3169)  div_loss: -4.3056 (-4.3056)  acc1: 0.0000 (0.0000)  time: 1.7653  data: 1.7510  max mem: 242
Val  [61/62]  eta: 0:00:00  loss: 0.3526 (0.8711)  div_loss: -5.5225 (-5.6457)  acc1: 100.0000 (64.5161)  time: 0.0180  data: 0.0017  max mem: 242
Val Total time: 0:00:03 (0.0601 s / it)
* Acc@1 64.516 loss 0.871 auroc 0.770 f1_score 0.645
Test  [ 0/86]  eta: 0:02:39  loss: 1.9497 (1.9497)  div_loss: -5.4559 (-5.4559)  acc1: 0.0000 (0.0000)  time: 1.8601  data: 1.8403  max mem: 242
Test  [85/86]  eta: 0:00:00  loss: 0.6077 (0.9494)  div_loss: -5.5693 (-5.6165)  acc1: 0.0000 (56.9767)  time: 0.0149  data: 0.0015  max mem: 242
Test Total time: 0:00:03 (0.0454 s / it)
* Acc@1 56.977 loss 0.949 auroc 0.745 f1_score 0.570
Epoch: [15]  [  0/389]  eta: 0:13:26  lr: 0.000079  sub_loss: 0.1496 (0.1496)  diff_loss: 0.0129 (0.0129)  slide_loss: 0.0793 (0.0793)  time: 2.0725  data: 2.0369  max mem: 242
Epoch: [15]  [100/389]  eta: 0:00:16  lr: 0.000079  sub_loss: 0.5576 (0.7016)  diff_loss: 0.0105 (0.0177)  slide_loss: 0.3637 (0.6087)  time: 0.0376  data: 0.0017  max mem: 242
Epoch: [15]  [200/389]  eta: 0:00:09  lr: 0.000078  sub_loss: 0.3482 (0.6259)  diff_loss: 0.0131 (0.0209)  slide_loss: 0.2216 (0.5012)  time: 0.0467  data: 0.0024  max mem: 242
Epoch: [15]  [300/389]  eta: 0:00:04  lr: 0.000077  sub_loss: 0.4895 (0.6280)  diff_loss: 0.0133 (0.0207)  slide_loss: 0.3903 (0.5125)  time: 0.0394  data: 0.0020  max mem: 242
Epoch: [15]  [388/389]  eta: 0:00:00  lr: 0.000077  sub_loss: 0.3724 (0.6362)  diff_loss: 0.0117 (0.0208)  slide_loss: 0.2360 (0.5307)  time: 0.0323  data: 0.0016  max mem: 242
Epoch: [15] Total time: 0:00:16 (0.0434 s / it)
Val  [ 0/62]  eta: 0:01:48  loss: 0.9260 (0.9260)  div_loss: -4.3765 (-4.3765)  acc1: 0.0000 (0.0000)  time: 1.7510  data: 1.7373  max mem: 242
Val  [61/62]  eta: 0:00:00  loss: 0.3129 (0.8087)  div_loss: -5.4918 (-5.6258)  acc1: 100.0000 (64.5161)  time: 0.0173  data: 0.0017  max mem: 242
Val Total time: 0:00:03 (0.0584 s / it)
* Acc@1 64.516 loss 0.809 auroc 0.777 f1_score 0.645
Test  [ 0/86]  eta: 0:03:05  loss: 1.9087 (1.9087)  div_loss: -5.4156 (-5.4156)  acc1: 0.0000 (0.0000)  time: 2.1613  data: 2.1357  max mem: 242
Test  [85/86]  eta: 0:00:00  loss: 0.4217 (0.9179)  div_loss: -5.6297 (-5.5985)  acc1: 0.0000 (54.6512)  time: 0.0165  data: 0.0025  max mem: 242
Test Total time: 0:00:03 (0.0458 s / it)
* Acc@1 54.651 loss 0.918 auroc 0.753 f1_score 0.547
Epoch: [16]  [  0/389]  eta: 0:13:06  lr: 0.000077  sub_loss: 0.0720 (0.0720)  diff_loss: 0.0346 (0.0346)  slide_loss: 0.0326 (0.0326)  time: 2.0208  data: 1.9724  max mem: 242
Epoch: [16]  [100/389]  eta: 0:00:17  lr: 0.000076  sub_loss: 0.4584 (0.5931)  diff_loss: 0.0167 (0.0217)  slide_loss: 0.2902 (0.4779)  time: 0.0385  data: 0.0027  max mem: 242
Epoch: [16]  [200/389]  eta: 0:00:09  lr: 0.000075  sub_loss: 0.2319 (0.5609)  diff_loss: 0.0181 (0.0215)  slide_loss: 0.1375 (0.4436)  time: 0.0340  data: 0.0016  max mem: 242
Epoch: [16]  [300/389]  eta: 0:00:03  lr: 0.000075  sub_loss: 0.3711 (0.5881)  diff_loss: 0.0119 (0.0214)  slide_loss: 0.1601 (0.4785)  time: 0.0324  data: 0.0016  max mem: 242
Epoch: [16]  [388/389]  eta: 0:00:00  lr: 0.000074  sub_loss: 0.5466 (0.6217)  diff_loss: 0.0111 (0.0209)  slide_loss: 0.3758 (0.5170)  time: 0.0260  data: 0.0012  max mem: 242
Epoch: [16] Total time: 0:00:16 (0.0425 s / it)
Val  [ 0/62]  eta: 0:02:08  loss: 0.9319 (0.9319)  div_loss: -4.3435 (-4.3435)  acc1: 0.0000 (0.0000)  time: 2.0669  data: 2.0563  max mem: 242
Val  [61/62]  eta: 0:00:00  loss: 0.3547 (0.7510)  div_loss: -5.3946 (-5.6498)  acc1: 100.0000 (62.9032)  time: 0.0131  data: 0.0013  max mem: 242
Val Total time: 0:00:03 (0.0588 s / it)
* Acc@1 62.903 loss 0.751 auroc 0.785 f1_score 0.629
Test  [ 0/86]  eta: 0:03:11  loss: 1.5698 (1.5698)  div_loss: -5.4937 (-5.4937)  acc1: 0.0000 (0.0000)  time: 2.2324  data: 2.2108  max mem: 242
Test  [85/86]  eta: 0:00:00  loss: 0.6864 (0.8934)  div_loss: -5.5900 (-5.6474)  acc1: 0.0000 (51.1628)  time: 0.0150  data: 0.0013  max mem: 242
Test Total time: 0:00:04 (0.0475 s / it)
* Acc@1 51.163 loss 0.893 auroc 0.746 f1_score 0.512
Epoch: [17]  [  0/389]  eta: 0:12:20  lr: 0.000074  sub_loss: 0.7138 (0.7138)  diff_loss: 0.0223 (0.0223)  slide_loss: 0.2389 (0.2389)  time: 1.9040  data: 1.8644  max mem: 242
Epoch: [17]  [100/389]  eta: 0:00:14  lr: 0.000073  sub_loss: 0.3680 (0.5955)  diff_loss: 0.0161 (0.0191)  slide_loss: 0.3533 (0.4480)  time: 0.0276  data: 0.0014  max mem: 242
Epoch: [17]  [200/389]  eta: 0:00:07  lr: 0.000073  sub_loss: 0.2075 (0.6208)  diff_loss: 0.0171 (0.0222)  slide_loss: 0.1047 (0.4952)  time: 0.0263  data: 0.0013  max mem: 242
Epoch: [17]  [300/389]  eta: 0:00:03  lr: 0.000072  sub_loss: 0.4764 (0.6107)  diff_loss: 0.0139 (0.0214)  slide_loss: 0.2785 (0.4830)  time: 0.0331  data: 0.0013  max mem: 242
Epoch: [17]  [388/389]  eta: 0:00:00  lr: 0.000071  sub_loss: 0.3596 (0.6177)  diff_loss: 0.0097 (0.0213)  slide_loss: 0.1863 (0.5022)  time: 0.0305  data: 0.0014  max mem: 242
Epoch: [17] Total time: 0:00:13 (0.0358 s / it)
Val  [ 0/62]  eta: 0:01:45  loss: 0.6398 (0.6398)  div_loss: -4.4330 (-4.4330)  acc1: 100.0000 (100.0000)  time: 1.7058  data: 1.6707  max mem: 242
Val  [61/62]  eta: 0:00:00  loss: 0.2345 (0.7882)  div_loss: -5.4072 (-5.6802)  acc1: 100.0000 (66.1290)  time: 0.0176  data: 0.0019  max mem: 242
Val Total time: 0:00:03 (0.0512 s / it)
* Acc@1 66.129 loss 0.788 auroc 0.785 f1_score 0.661
Test  [ 0/86]  eta: 0:02:51  loss: 1.6433 (1.6433)  div_loss: -5.8240 (-5.8240)  acc1: 0.0000 (0.0000)  time: 1.9934  data: 1.9595  max mem: 242
Test  [85/86]  eta: 0:00:00  loss: 0.6997 (0.9142)  div_loss: -5.6400 (-5.6966)  acc1: 0.0000 (59.3023)  time: 0.0154  data: 0.0020  max mem: 242
Test Total time: 0:00:03 (0.0435 s / it)
* Acc@1 59.302 loss 0.914 auroc 0.753 f1_score 0.593
Epoch: [18]  [  0/389]  eta: 0:12:05  lr: 0.000071  sub_loss: 2.0022 (2.0022)  diff_loss: 0.0094 (0.0094)  slide_loss: 2.4161 (2.4161)  time: 1.8655  data: 1.8244  max mem: 242
Epoch: [18]  [100/389]  eta: 0:00:14  lr: 0.000071  sub_loss: 0.5673 (0.6248)  diff_loss: 0.0127 (0.0190)  slide_loss: 0.3578 (0.4908)  time: 0.0271  data: 0.0013  max mem: 242
Epoch: [18]  [200/389]  eta: 0:00:07  lr: 0.000070  sub_loss: 0.3805 (0.6130)  diff_loss: 0.0126 (0.0196)  slide_loss: 0.1265 (0.5002)  time: 0.0323  data: 0.0014  max mem: 242
Epoch: [18]  [300/389]  eta: 0:00:03  lr: 0.000069  sub_loss: 0.4781 (0.6220)  diff_loss: 0.0103 (0.0195)  slide_loss: 0.3287 (0.5148)  time: 0.0359  data: 0.0017  max mem: 242
Epoch: [18]  [388/389]  eta: 0:00:00  lr: 0.000068  sub_loss: 0.5997 (0.6074)  diff_loss: 0.0135 (0.0191)  slide_loss: 0.2410 (0.4927)  time: 0.0303  data: 0.0014  max mem: 242
Epoch: [18] Total time: 0:00:14 (0.0381 s / it)
Val  [ 0/62]  eta: 0:01:56  loss: 0.8977 (0.8977)  div_loss: -4.3755 (-4.3755)  acc1: 0.0000 (0.0000)  time: 1.8818  data: 1.8705  max mem: 242
Val  [61/62]  eta: 0:00:00  loss: 0.1740 (0.8432)  div_loss: -5.3032 (-5.5082)  acc1: 100.0000 (67.7419)  time: 0.0143  data: 0.0014  max mem: 242
Val Total time: 0:00:03 (0.0509 s / it)
* Acc@1 67.742 loss 0.843 auroc 0.787 f1_score 0.677
Test  [ 0/86]  eta: 0:03:00  loss: 2.1059 (2.1059)  div_loss: -5.5408 (-5.5408)  acc1: 0.0000 (0.0000)  time: 2.0941  data: 2.0594  max mem: 242
Test  [85/86]  eta: 0:00:00  loss: 0.4580 (0.9463)  div_loss: -5.4530 (-5.4935)  acc1: 0.0000 (54.6512)  time: 0.0100  data: 0.0012  max mem: 242
Test Total time: 0:00:03 (0.0437 s / it)
* Acc@1 54.651 loss 0.946 auroc 0.753 f1_score 0.547
Epoch: [19]  [  0/389]  eta: 0:10:44  lr: 0.000068  sub_loss: 1.4959 (1.4959)  diff_loss: 0.0055 (0.0055)  slide_loss: 1.3652 (1.3652)  time: 1.6573  data: 1.6080  max mem: 242
Epoch: [19]  [100/389]  eta: 0:00:13  lr: 0.000068  sub_loss: 0.3665 (0.5489)  diff_loss: 0.0125 (0.0229)  slide_loss: 0.1783 (0.3734)  time: 0.0312  data: 0.0013  max mem: 242
Epoch: [19]  [200/389]  eta: 0:00:07  lr: 0.000067  sub_loss: 0.4683 (0.5801)  diff_loss: 0.0114 (0.0208)  slide_loss: 0.2279 (0.4363)  time: 0.0348  data: 0.0017  max mem: 242
Epoch: [19]  [300/389]  eta: 0:00:03  lr: 0.000066  sub_loss: 0.3040 (0.5647)  diff_loss: 0.0163 (0.0202)  slide_loss: 0.1302 (0.4325)  time: 0.0306  data: 0.0015  max mem: 242
Epoch: [19]  [388/389]  eta: 0:00:00  lr: 0.000065  sub_loss: 0.2159 (0.5929)  diff_loss: 0.0121 (0.0195)  slide_loss: 0.0969 (0.4688)  time: 0.0308  data: 0.0012  max mem: 242
Epoch: [19] Total time: 0:00:14 (0.0368 s / it)
Val  [ 0/62]  eta: 0:01:47  loss: 0.4862 (0.4862)  div_loss: -4.3621 (-4.3621)  acc1: 100.0000 (100.0000)  time: 1.7354  data: 1.7249  max mem: 242
Val  [61/62]  eta: 0:00:00  loss: 0.1941 (0.8058)  div_loss: -5.3021 (-5.5287)  acc1: 100.0000 (67.7419)  time: 0.0174  data: 0.0016  max mem: 242
Val Total time: 0:00:03 (0.0512 s / it)
* Acc@1 67.742 loss 0.806 auroc 0.791 f1_score 0.677
Test  [ 0/86]  eta: 0:02:11  loss: 2.2061 (2.2061)  div_loss: -5.4123 (-5.4123)  acc1: 0.0000 (0.0000)  time: 1.5264  data: 1.5059  max mem: 242
Test  [85/86]  eta: 0:00:00  loss: 0.5012 (0.9719)  div_loss: -5.4796 (-5.5171)  acc1: 0.0000 (58.1395)  time: 0.0196  data: 0.0020  max mem: 242
Test Total time: 0:00:03 (0.0424 s / it)
* Acc@1 58.140 loss 0.972 auroc 0.752 f1_score 0.581
Epoch: [20]  [  0/389]  eta: 0:12:01  lr: 0.000065  sub_loss: 1.5402 (1.5402)  diff_loss: 0.0066 (0.0066)  slide_loss: 1.4190 (1.4190)  time: 1.8560  data: 1.7841  max mem: 242
Epoch: [20]  [100/389]  eta: 0:00:17  lr: 0.000065  sub_loss: 0.6048 (0.6163)  diff_loss: 0.0155 (0.0178)  slide_loss: 0.3193 (0.5047)  time: 0.0447  data: 0.0022  max mem: 242
Epoch: [20]  [200/389]  eta: 0:00:09  lr: 0.000064  sub_loss: 0.2723 (0.6003)  diff_loss: 0.0113 (0.0188)  slide_loss: 0.1197 (0.4856)  time: 0.0414  data: 0.0019  max mem: 242
Epoch: [20]  [300/389]  eta: 0:00:04  lr: 0.000063  sub_loss: 0.4204 (0.5869)  diff_loss: 0.0117 (0.0184)  slide_loss: 0.1947 (0.4745)  time: 0.0320  data: 0.0015  max mem: 242
Epoch: [20]  [388/389]  eta: 0:00:00  lr: 0.000062  sub_loss: 0.3139 (0.6001)  diff_loss: 0.0099 (0.0188)  slide_loss: 0.1246 (0.4862)  time: 0.0339  data: 0.0014  max mem: 242
Epoch: [20] Total time: 0:00:17 (0.0443 s / it)
Val  [ 0/62]  eta: 0:02:11  loss: 0.4891 (0.4891)  div_loss: -4.4676 (-4.4676)  acc1: 100.0000 (100.0000)  time: 2.1170  data: 2.1011  max mem: 242
Val  [61/62]  eta: 0:00:00  loss: 0.1543 (0.8377)  div_loss: -5.3451 (-5.5939)  acc1: 100.0000 (67.7419)  time: 0.0169  data: 0.0015  max mem: 242
Val Total time: 0:00:04 (0.0646 s / it)
* Acc@1 67.742 loss 0.838 auroc 0.788 f1_score 0.677
Test  [ 0/86]  eta: 0:02:36  loss: 1.7901 (1.7901)  div_loss: -5.7533 (-5.7533)  acc1: 0.0000 (0.0000)  time: 1.8166  data: 1.7959  max mem: 242
Test  [85/86]  eta: 0:00:00  loss: 0.5326 (0.9336)  div_loss: -5.4337 (-5.5515)  acc1: 0.0000 (59.3023)  time: 0.0165  data: 0.0015  max mem: 242
Test Total time: 0:00:04 (0.0471 s / it)
* Acc@1 59.302 loss 0.934 auroc 0.755 f1_score 0.593
Epoch: [21]  [  0/389]  eta: 0:12:49  lr: 0.000062  sub_loss: 0.1717 (0.1717)  diff_loss: 0.0168 (0.0168)  slide_loss: 0.0724 (0.0724)  time: 1.9794  data: 1.9380  max mem: 242
Epoch: [21]  [100/389]  eta: 0:00:17  lr: 0.000062  sub_loss: 0.4410 (0.6513)  diff_loss: 0.0103 (0.0180)  slide_loss: 0.3586 (0.5173)  time: 0.0466  data: 0.0027  max mem: 242
Epoch: [21]  [200/389]  eta: 0:00:09  lr: 0.000061  sub_loss: 0.2625 (0.6616)  diff_loss: 0.0139 (0.0181)  slide_loss: 0.0802 (0.5472)  time: 0.0407  data: 0.0029  max mem: 242
Epoch: [21]  [300/389]  eta: 0:00:04  lr: 0.000060  sub_loss: 0.3708 (0.6241)  diff_loss: 0.0113 (0.0178)  slide_loss: 0.1514 (0.5063)  time: 0.0455  data: 0.0021  max mem: 242
Epoch: [21]  [388/389]  eta: 0:00:00  lr: 0.000059  sub_loss: 0.3204 (0.5904)  diff_loss: 0.0161 (0.0180)  slide_loss: 0.1020 (0.4686)  time: 0.0334  data: 0.0016  max mem: 242
Epoch: [21] Total time: 0:00:17 (0.0437 s / it)
Val  [ 0/62]  eta: 0:01:39  loss: 0.5175 (0.5175)  div_loss: -4.4374 (-4.4374)  acc1: 100.0000 (100.0000)  time: 1.6105  data: 1.5892  max mem: 242
Val  [61/62]  eta: 0:00:00  loss: 0.1075 (0.8505)  div_loss: -5.3443 (-5.5949)  acc1: 100.0000 (66.1290)  time: 0.0229  data: 0.0029  max mem: 242
Val Total time: 0:00:03 (0.0557 s / it)
* Acc@1 66.129 loss 0.851 auroc 0.787 f1_score 0.661
Test  [ 0/86]  eta: 0:02:31  loss: 2.0759 (2.0759)  div_loss: -5.6539 (-5.6539)  acc1: 0.0000 (0.0000)  time: 1.7563  data: 1.7396  max mem: 242
Test  [85/86]  eta: 0:00:00  loss: 0.4754 (0.9634)  div_loss: -5.3954 (-5.5366)  acc1: 0.0000 (59.3023)  time: 0.0158  data: 0.0019  max mem: 242
Test Total time: 0:00:04 (0.0468 s / it)
* Acc@1 59.302 loss 0.963 auroc 0.755 f1_score 0.593
Epoch: [22]  [  0/389]  eta: 0:15:01  lr: 0.000059  sub_loss: 0.1631 (0.1631)  diff_loss: 0.0214 (0.0214)  slide_loss: 0.0193 (0.0193)  time: 2.3173  data: 2.2409  max mem: 242
Epoch: [22]  [100/389]  eta: 0:00:17  lr: 0.000059  sub_loss: 0.2622 (0.5885)  diff_loss: 0.0112 (0.0185)  slide_loss: 0.1472 (0.4849)  time: 0.0403  data: 0.0019  max mem: 242
Epoch: [22]  [200/389]  eta: 0:00:09  lr: 0.000058  sub_loss: 0.3637 (0.5868)  diff_loss: 0.0125 (0.0192)  slide_loss: 0.1040 (0.4873)  time: 0.0301  data: 0.0014  max mem: 242
Epoch: [22]  [300/389]  eta: 0:00:04  lr: 0.000057  sub_loss: 0.3327 (0.5763)  diff_loss: 0.0146 (0.0193)  slide_loss: 0.1181 (0.4707)  time: 0.0411  data: 0.0019  max mem: 242
Epoch: [22]  [388/389]  eta: 0:00:00  lr: 0.000056  sub_loss: 0.3766 (0.5832)  diff_loss: 0.0171 (0.0189)  slide_loss: 0.2663 (0.4725)  time: 0.0377  data: 0.0022  max mem: 242
Epoch: [22] Total time: 0:00:17 (0.0442 s / it)
Val  [ 0/62]  eta: 0:01:53  loss: 0.7222 (0.7222)  div_loss: -4.3297 (-4.3297)  acc1: 100.0000 (100.0000)  time: 1.8353  data: 1.8085  max mem: 242
Val  [61/62]  eta: 0:00:00  loss: 0.2774 (0.7521)  div_loss: -5.4421 (-5.5335)  acc1: 100.0000 (62.9032)  time: 0.0213  data: 0.0016  max mem: 242
Val Total time: 0:00:03 (0.0588 s / it)
* Acc@1 62.903 loss 0.752 auroc 0.794 f1_score 0.629
Test  [ 0/86]  eta: 0:02:54  loss: 1.3995 (1.3995)  div_loss: -5.4296 (-5.4296)  acc1: 0.0000 (0.0000)  time: 2.0342  data: 2.0073  max mem: 242
Test  [85/86]  eta: 0:00:00  loss: 0.7292 (0.9088)  div_loss: -5.4627 (-5.4587)  acc1: 0.0000 (50.0000)  time: 0.0198  data: 0.0026  max mem: 242
Test Total time: 0:00:04 (0.0498 s / it)
* Acc@1 50.000 loss 0.909 auroc 0.742 f1_score 0.500
Epoch: [23]  [  0/389]  eta: 0:14:04  lr: 0.000056  sub_loss: 1.9978 (1.9978)  diff_loss: 0.0066 (0.0066)  slide_loss: 2.5102 (2.5102)  time: 2.1714  data: 2.1106  max mem: 242
Epoch: [23]  [100/389]  eta: 0:00:16  lr: 0.000055  sub_loss: 0.3352 (0.5094)  diff_loss: 0.0105 (0.0211)  slide_loss: 0.1288 (0.4298)  time: 0.0316  data: 0.0014  max mem: 242
Epoch: [23]  [200/389]  eta: 0:00:08  lr: 0.000055  sub_loss: 0.5103 (0.6004)  diff_loss: 0.0093 (0.0177)  slide_loss: 0.2802 (0.5093)  time: 0.0370  data: 0.0017  max mem: 242
Epoch: [23]  [300/389]  eta: 0:00:03  lr: 0.000054  sub_loss: 0.5112 (0.5938)  diff_loss: 0.0165 (0.0177)  slide_loss: 0.4302 (0.4895)  time: 0.0445  data: 0.0023  max mem: 242
Epoch: [23]  [388/389]  eta: 0:00:00  lr: 0.000053  sub_loss: 0.2601 (0.5772)  diff_loss: 0.0108 (0.0175)  slide_loss: 0.1071 (0.4607)  time: 0.0418  data: 0.0016  max mem: 242
Epoch: [23] Total time: 0:00:16 (0.0436 s / it)
Val  [ 0/62]  eta: 0:02:04  loss: 0.5344 (0.5344)  div_loss: -4.4275 (-4.4275)  acc1: 100.0000 (100.0000)  time: 2.0157  data: 1.9939  max mem: 242
Val  [61/62]  eta: 0:00:00  loss: 0.0993 (0.8821)  div_loss: -5.2586 (-5.4936)  acc1: 100.0000 (66.1290)  time: 0.0218  data: 0.0022  max mem: 242
Val Total time: 0:00:03 (0.0615 s / it)
* Acc@1 66.129 loss 0.882 auroc 0.781 f1_score 0.661
Test  [ 0/86]  eta: 0:02:33  loss: 2.2231 (2.2231)  div_loss: -5.4670 (-5.4670)  acc1: 0.0000 (0.0000)  time: 1.7902  data: 1.7606  max mem: 242
Test  [85/86]  eta: 0:00:00  loss: 0.4006 (0.9788)  div_loss: -5.3586 (-5.4428)  acc1: 0.0000 (59.3023)  time: 0.0183  data: 0.0019  max mem: 242
Test Total time: 0:00:04 (0.0471 s / it)
* Acc@1 59.302 loss 0.979 auroc 0.754 f1_score 0.593
Epoch: [24]  [  0/389]  eta: 0:11:37  lr: 0.000053  sub_loss: 0.2993 (0.2993)  diff_loss: 0.0102 (0.0102)  slide_loss: 0.0908 (0.0908)  time: 1.7924  data: 1.7374  max mem: 242
Epoch: [24]  [100/389]  eta: 0:00:18  lr: 0.000052  sub_loss: 0.2480 (0.5653)  diff_loss: 0.0103 (0.0174)  slide_loss: 0.1124 (0.4547)  time: 0.0405  data: 0.0023  max mem: 242
Epoch: [24]  [200/389]  eta: 0:00:09  lr: 0.000052  sub_loss: 0.7813 (0.5690)  diff_loss: 0.0099 (0.0179)  slide_loss: 0.4556 (0.4547)  time: 0.0330  data: 0.0014  max mem: 242
Epoch: [24]  [300/389]  eta: 0:00:04  lr: 0.000051  sub_loss: 0.4250 (0.5697)  diff_loss: 0.0112 (0.0180)  slide_loss: 0.2522 (0.4501)  time: 0.0351  data: 0.0017  max mem: 242
Epoch: [24]  [388/389]  eta: 0:00:00  lr: 0.000050  sub_loss: 0.2576 (0.5794)  diff_loss: 0.0115 (0.0176)  slide_loss: 0.1051 (0.4584)  time: 0.0279  data: 0.0016  max mem: 242
Epoch: [24] Total time: 0:00:17 (0.0449 s / it)
Val  [ 0/62]  eta: 0:02:12  loss: 0.7066 (0.7066)  div_loss: -4.3910 (-4.3910)  acc1: 100.0000 (100.0000)  time: 2.1363  data: 2.1194  max mem: 242
Val  [61/62]  eta: 0:00:00  loss: 0.1307 (0.8615)  div_loss: -5.2715 (-5.4767)  acc1: 100.0000 (66.1290)  time: 0.0210  data: 0.0045  max mem: 242
Val Total time: 0:00:03 (0.0612 s / it)
* Acc@1 66.129 loss 0.862 auroc 0.779 f1_score 0.661
Test  [ 0/86]  eta: 0:02:49  loss: 2.0300 (2.0300)  div_loss: -5.5807 (-5.5807)  acc1: 0.0000 (0.0000)  time: 1.9749  data: 1.9498  max mem: 242
Test  [85/86]  eta: 0:00:00  loss: 0.5882 (0.9730)  div_loss: -5.3731 (-5.4358)  acc1: 0.0000 (58.1395)  time: 0.0193  data: 0.0023  max mem: 242
Test Total time: 0:00:04 (0.0470 s / it)
* Acc@1 58.140 loss 0.973 auroc 0.749 f1_score 0.581
Epoch: [25]  [  0/389]  eta: 0:11:39  lr: 0.000050  sub_loss: 0.2860 (0.2860)  diff_loss: 0.0052 (0.0052)  slide_loss: 0.1675 (0.1675)  time: 1.7983  data: 1.7289  max mem: 242
Epoch: [25]  [100/389]  eta: 0:00:15  lr: 0.000049  sub_loss: 0.2351 (0.6378)  diff_loss: 0.0096 (0.0150)  slide_loss: 0.0522 (0.5283)  time: 0.0390  data: 0.0020  max mem: 242
Epoch: [25]  [200/389]  eta: 0:00:08  lr: 0.000048  sub_loss: 0.2045 (0.6191)  diff_loss: 0.0126 (0.0155)  slide_loss: 0.1167 (0.4997)  time: 0.0383  data: 0.0017  max mem: 242
Epoch: [25]  [300/389]  eta: 0:00:03  lr: 0.000048  sub_loss: 0.1604 (0.5808)  diff_loss: 0.0118 (0.0160)  slide_loss: 0.0638 (0.4593)  time: 0.0352  data: 0.0018  max mem: 242
Epoch: [25]  [388/389]  eta: 0:00:00  lr: 0.000047  sub_loss: 0.2179 (0.5682)  diff_loss: 0.0146 (0.0168)  slide_loss: 0.0896 (0.4445)  time: 0.0362  data: 0.0018  max mem: 242
Epoch: [25] Total time: 0:00:16 (0.0434 s / it)
Val  [ 0/62]  eta: 0:01:54  loss: 0.7891 (0.7891)  div_loss: -4.2859 (-4.2859)  acc1: 100.0000 (100.0000)  time: 1.8458  data: 1.8300  max mem: 242
Val  [61/62]  eta: 0:00:00  loss: 0.1668 (0.8421)  div_loss: -5.0912 (-5.3709)  acc1: 100.0000 (66.1290)  time: 0.0164  data: 0.0018  max mem: 242
Val Total time: 0:00:03 (0.0584 s / it)
* Acc@1 66.129 loss 0.842 auroc 0.780 f1_score 0.661
Test  [ 0/86]  eta: 0:02:48  loss: 2.3700 (2.3700)  div_loss: -5.1891 (-5.1891)  acc1: 0.0000 (0.0000)  time: 1.9594  data: 1.9405  max mem: 242
Test  [85/86]  eta: 0:00:00  loss: 0.3863 (0.9662)  div_loss: -5.3184 (-5.3146)  acc1: 0.0000 (58.1395)  time: 0.0120  data: 0.0012  max mem: 242
Test Total time: 0:00:03 (0.0444 s / it)
* Acc@1 58.140 loss 0.966 auroc 0.748 f1_score 0.581
Epoch: [26]  [  0/389]  eta: 0:12:38  lr: 0.000047  sub_loss: 0.0652 (0.0652)  diff_loss: 0.0466 (0.0466)  slide_loss: 0.0124 (0.0124)  time: 1.9509  data: 1.8925  max mem: 242
Epoch: [26]  [100/389]  eta: 0:00:16  lr: 0.000046  sub_loss: 0.1521 (0.4625)  diff_loss: 0.0138 (0.0185)  slide_loss: 0.0528 (0.3282)  time: 0.0371  data: 0.0020  max mem: 242
Epoch: [26]  [200/389]  eta: 0:00:08  lr: 0.000045  sub_loss: 0.4896 (0.5304)  diff_loss: 0.0111 (0.0168)  slide_loss: 0.1256 (0.4252)  time: 0.0320  data: 0.0019  max mem: 242
Epoch: [26]  [300/389]  eta: 0:00:03  lr: 0.000044  sub_loss: 0.3794 (0.5685)  diff_loss: 0.0107 (0.0161)  slide_loss: 0.1801 (0.4520)  time: 0.0282  data: 0.0016  max mem: 242
Epoch: [26]  [388/389]  eta: 0:00:00  lr: 0.000044  sub_loss: 0.3477 (0.5722)  diff_loss: 0.0122 (0.0169)  slide_loss: 0.2349 (0.4511)  time: 0.0339  data: 0.0015  max mem: 242
Epoch: [26] Total time: 0:00:16 (0.0417 s / it)
Val  [ 0/62]  eta: 0:01:59  loss: 1.1460 (1.1460)  div_loss: -4.2626 (-4.2626)  acc1: 0.0000 (0.0000)  time: 1.9323  data: 1.9201  max mem: 242
Val  [61/62]  eta: 0:00:00  loss: 0.1428 (0.9531)  div_loss: -5.1045 (-5.3483)  acc1: 100.0000 (59.6774)  time: 0.0227  data: 0.0026  max mem: 242
Val Total time: 0:00:03 (0.0633 s / it)
* Acc@1 59.677 loss 0.953 auroc 0.775 f1_score 0.597
Test  [ 0/86]  eta: 0:03:02  loss: 3.0910 (3.0910)  div_loss: -5.0222 (-5.0222)  acc1: 0.0000 (0.0000)  time: 2.1236  data: 2.0995  max mem: 242
Test  [85/86]  eta: 0:00:00  loss: 0.4872 (1.0475)  div_loss: -5.3099 (-5.3002)  acc1: 0.0000 (56.9767)  time: 0.0175  data: 0.0019  max mem: 242
Test Total time: 0:00:03 (0.0463 s / it)
* Acc@1 56.977 loss 1.047 auroc 0.747 f1_score 0.570
Epoch: [27]  [  0/389]  eta: 0:11:24  lr: 0.000044  sub_loss: 0.1459 (0.1459)  diff_loss: 0.0094 (0.0094)  slide_loss: 0.0672 (0.0672)  time: 1.7602  data: 1.7173  max mem: 242
Epoch: [27]  [100/389]  eta: 0:00:15  lr: 0.000043  sub_loss: 0.4023 (0.5735)  diff_loss: 0.0106 (0.0172)  slide_loss: 0.2291 (0.4512)  time: 0.0430  data: 0.0036  max mem: 242
Epoch: [27]  [200/389]  eta: 0:00:08  lr: 0.000042  sub_loss: 0.1910 (0.5641)  diff_loss: 0.0104 (0.0180)  slide_loss: 0.1374 (0.4530)  time: 0.0389  data: 0.0018  max mem: 242
Epoch: [27]  [300/389]  eta: 0:00:03  lr: 0.000041  sub_loss: 0.2033 (0.5635)  diff_loss: 0.0125 (0.0168)  slide_loss: 0.1214 (0.4369)  time: 0.0347  data: 0.0024  max mem: 242
Epoch: [27]  [388/389]  eta: 0:00:00  lr: 0.000041  sub_loss: 0.3278 (0.5654)  diff_loss: 0.0098 (0.0164)  slide_loss: 0.2223 (0.4456)  time: 0.0383  data: 0.0016  max mem: 242
Epoch: [27] Total time: 0:00:16 (0.0436 s / it)
Val  [ 0/62]  eta: 0:01:57  loss: 0.7373 (0.7373)  div_loss: -4.3620 (-4.3620)  acc1: 100.0000 (100.0000)  time: 1.8915  data: 1.8754  max mem: 242
Val  [61/62]  eta: 0:00:00  loss: 0.1404 (0.8488)  div_loss: -5.0985 (-5.4211)  acc1: 100.0000 (67.7419)  time: 0.0135  data: 0.0014  max mem: 242
Val Total time: 0:00:03 (0.0567 s / it)
* Acc@1 67.742 loss 0.849 auroc 0.779 f1_score 0.677
Test  [ 0/86]  eta: 0:02:35  loss: 2.1869 (2.1869)  div_loss: -5.2698 (-5.2698)  acc1: 0.0000 (0.0000)  time: 1.8036  data: 1.7687  max mem: 242
Test  [85/86]  eta: 0:00:00  loss: 0.5083 (0.9592)  div_loss: -5.3465 (-5.4022)  acc1: 0.0000 (56.9767)  time: 0.0128  data: 0.0012  max mem: 242
Test Total time: 0:00:03 (0.0443 s / it)
* Acc@1 56.977 loss 0.959 auroc 0.746 f1_score 0.570
Epoch: [28]  [  0/389]  eta: 0:12:17  lr: 0.000041  sub_loss: 0.3790 (0.3790)  diff_loss: 0.0081 (0.0081)  slide_loss: 0.2507 (0.2507)  time: 1.8957  data: 1.8236  max mem: 242
Epoch: [28]  [100/389]  eta: 0:00:16  lr: 0.000040  sub_loss: 0.2705 (0.4571)  diff_loss: 0.0127 (0.0198)  slide_loss: 0.1797 (0.3199)  time: 0.0440  data: 0.0017  max mem: 242
Epoch: [28]  [200/389]  eta: 0:00:09  lr: 0.000039  sub_loss: 0.5202 (0.5421)  diff_loss: 0.0092 (0.0211)  slide_loss: 0.3136 (0.4023)  time: 0.0349  data: 0.0016  max mem: 242
Epoch: [28]  [300/389]  eta: 0:00:03  lr: 0.000038  sub_loss: 0.7086 (0.5417)  diff_loss: 0.0106 (0.0197)  slide_loss: 0.2824 (0.4074)  time: 0.0328  data: 0.0015  max mem: 242
Epoch: [28]  [388/389]  eta: 0:00:00  lr: 0.000038  sub_loss: 0.2279 (0.5582)  diff_loss: 0.0107 (0.0190)  slide_loss: 0.1159 (0.4289)  time: 0.0295  data: 0.0014  max mem: 242
Epoch: [28] Total time: 0:00:16 (0.0427 s / it)
Val  [ 0/62]  eta: 0:01:58  loss: 0.7221 (0.7221)  div_loss: -4.3045 (-4.3045)  acc1: 100.0000 (100.0000)  time: 1.9057  data: 1.8846  max mem: 242
Val  [61/62]  eta: 0:00:00  loss: 0.1369 (0.8107)  div_loss: -5.1543 (-5.3763)  acc1: 100.0000 (69.3548)  time: 0.0177  data: 0.0016  max mem: 242
Val Total time: 0:00:03 (0.0591 s / it)
* Acc@1 69.355 loss 0.811 auroc 0.789 f1_score 0.694
Test  [ 0/86]  eta: 0:03:10  loss: 2.2159 (2.2159)  div_loss: -5.1385 (-5.1385)  acc1: 0.0000 (0.0000)  time: 2.2122  data: 2.1830  max mem: 242
Test  [85/86]  eta: 0:00:00  loss: 0.4541 (0.9598)  div_loss: -5.2891 (-5.3198)  acc1: 0.0000 (55.8140)  time: 0.0179  data: 0.0024  max mem: 242
Test Total time: 0:00:04 (0.0505 s / it)
* Acc@1 55.814 loss 0.960 auroc 0.747 f1_score 0.558
Epoch: [29]  [  0/389]  eta: 0:13:04  lr: 0.000038  sub_loss: 0.0541 (0.0541)  diff_loss: 0.0174 (0.0174)  slide_loss: 0.0285 (0.0285)  time: 2.0161  data: 1.9713  max mem: 242
Epoch: [29]  [100/389]  eta: 0:00:16  lr: 0.000037  sub_loss: 0.1824 (0.6539)  diff_loss: 0.0100 (0.0158)  slide_loss: 0.0795 (0.5009)  time: 0.0339  data: 0.0019  max mem: 242
Epoch: [29]  [200/389]  eta: 0:00:08  lr: 0.000036  sub_loss: 0.4205 (0.5865)  diff_loss: 0.0105 (0.0161)  slide_loss: 0.2073 (0.4501)  time: 0.0404  data: 0.0020  max mem: 242
Epoch: [29]  [300/389]  eta: 0:00:03  lr: 0.000035  sub_loss: 0.4116 (0.5501)  diff_loss: 0.0154 (0.0160)  slide_loss: 0.0961 (0.4117)  time: 0.0434  data: 0.0040  max mem: 242
Epoch: [29]  [388/389]  eta: 0:00:00  lr: 0.000035  sub_loss: 0.2476 (0.5464)  diff_loss: 0.0126 (0.0169)  slide_loss: 0.1387 (0.4148)  time: 0.0401  data: 0.0026  max mem: 242
Epoch: [29] Total time: 0:00:16 (0.0436 s / it)
Val  [ 0/62]  eta: 0:01:55  loss: 0.7521 (0.7521)  div_loss: -4.3335 (-4.3335)  acc1: 100.0000 (100.0000)  time: 1.8596  data: 1.8484  max mem: 242
Val  [61/62]  eta: 0:00:00  loss: 0.1216 (0.8688)  div_loss: -5.1509 (-5.3239)  acc1: 100.0000 (67.7419)  time: 0.0216  data: 0.0021  max mem: 242
Val Total time: 0:00:04 (0.0713 s / it)
* Acc@1 67.742 loss 0.869 auroc 0.783 f1_score 0.677
Test  [ 0/86]  eta: 0:03:22  loss: 2.4288 (2.4288)  div_loss: -5.1914 (-5.1914)  acc1: 0.0000 (0.0000)  time: 2.3539  data: 2.3282  max mem: 242
Test  [85/86]  eta: 0:00:00  loss: 0.3159 (0.9851)  div_loss: -5.2229 (-5.2675)  acc1: 0.0000 (56.9767)  time: 0.0147  data: 0.0019  max mem: 242
Test Total time: 0:00:04 (0.0509 s / it)
* Acc@1 56.977 loss 0.985 auroc 0.751 f1_score 0.570
Epoch: [30]  [  0/389]  eta: 0:12:47  lr: 0.000035  sub_loss: 0.1266 (0.1266)  diff_loss: 0.0044 (0.0044)  slide_loss: 0.0944 (0.0944)  time: 1.9737  data: 1.9330  max mem: 242
Epoch: [30]  [100/389]  eta: 0:00:16  lr: 0.000034  sub_loss: 0.3445 (0.5820)  diff_loss: 0.0121 (0.0168)  slide_loss: 0.0932 (0.4549)  time: 0.0378  data: 0.0020  max mem: 242
Epoch: [30]  [200/389]  eta: 0:00:08  lr: 0.000033  sub_loss: 0.2975 (0.5195)  diff_loss: 0.0110 (0.0165)  slide_loss: 0.0760 (0.3944)  time: 0.0356  data: 0.0019  max mem: 242
Epoch: [30]  [300/389]  eta: 0:00:03  lr: 0.000032  sub_loss: 0.1920 (0.5399)  diff_loss: 0.0106 (0.0165)  slide_loss: 0.0800 (0.4130)  time: 0.0340  data: 0.0017  max mem: 242
Epoch: [30]  [388/389]  eta: 0:00:00  lr: 0.000032  sub_loss: 0.2931 (0.5426)  diff_loss: 0.0123 (0.0164)  slide_loss: 0.1647 (0.4157)  time: 0.0363  data: 0.0014  max mem: 242
Epoch: [30] Total time: 0:00:16 (0.0433 s / it)
Val  [ 0/62]  eta: 0:02:11  loss: 0.3744 (0.3744)  div_loss: -4.3909 (-4.3909)  acc1: 100.0000 (100.0000)  time: 2.1193  data: 2.1059  max mem: 242
Val  [61/62]  eta: 0:00:00  loss: 0.2209 (0.8166)  div_loss: -5.2784 (-5.4099)  acc1: 100.0000 (70.9677)  time: 0.0209  data: 0.0023  max mem: 242
Val Total time: 0:00:03 (0.0633 s / it)
* Acc@1 70.968 loss 0.817 auroc 0.804 f1_score 0.710
Test  [ 0/86]  eta: 0:02:55  loss: 1.4237 (1.4237)  div_loss: -5.4706 (-5.4706)  acc1: 0.0000 (0.0000)  time: 2.0433  data: 2.0213  max mem: 242
Test  [85/86]  eta: 0:00:00  loss: 0.8561 (1.0231)  div_loss: -5.2573 (-5.3651)  acc1: 100.0000 (59.3023)  time: 0.0133  data: 0.0012  max mem: 242
Test Total time: 0:00:03 (0.0442 s / it)
* Acc@1 59.302 loss 1.023 auroc 0.746 f1_score 0.593
Epoch: [31]  [  0/389]  eta: 0:14:19  lr: 0.000032  sub_loss: 0.4779 (0.4779)  diff_loss: 0.0087 (0.0087)  slide_loss: 0.1835 (0.1835)  time: 2.2108  data: 2.1775  max mem: 242
Epoch: [31]  [100/389]  eta: 0:00:15  lr: 0.000031  sub_loss: 0.1718 (0.5383)  diff_loss: 0.0093 (0.0179)  slide_loss: 0.0969 (0.3856)  time: 0.0400  data: 0.0023  max mem: 242
Epoch: [31]  [200/389]  eta: 0:00:08  lr: 0.000030  sub_loss: 0.4177 (0.5257)  diff_loss: 0.0101 (0.0174)  slide_loss: 0.2327 (0.3846)  time: 0.0394  data: 0.0016  max mem: 242
Epoch: [31]  [300/389]  eta: 0:00:03  lr: 0.000029  sub_loss: 0.2747 (0.5362)  diff_loss: 0.0103 (0.0170)  slide_loss: 0.0984 (0.4039)  time: 0.0428  data: 0.0023  max mem: 242
Epoch: [31]  [388/389]  eta: 0:00:00  lr: 0.000029  sub_loss: 0.3777 (0.5479)  diff_loss: 0.0093 (0.0160)  slide_loss: 0.2130 (0.4156)  time: 0.0425  data: 0.0018  max mem: 242
Epoch: [31] Total time: 0:00:17 (0.0447 s / it)
Val  [ 0/62]  eta: 0:01:48  loss: 1.0340 (1.0340)  div_loss: -4.2439 (-4.2439)  acc1: 0.0000 (0.0000)  time: 1.7569  data: 1.7400  max mem: 242
Val  [61/62]  eta: 0:00:00  loss: 0.1863 (0.8280)  div_loss: -5.0775 (-5.2519)  acc1: 100.0000 (64.5161)  time: 0.0158  data: 0.0015  max mem: 242
Val Total time: 0:00:03 (0.0557 s / it)
* Acc@1 64.516 loss 0.828 auroc 0.783 f1_score 0.645
Test  [ 0/86]  eta: 0:02:17  loss: 1.8864 (1.8864)  div_loss: -5.1620 (-5.1620)  acc1: 0.0000 (0.0000)  time: 1.5976  data: 1.5724  max mem: 242
Test  [85/86]  eta: 0:00:00  loss: 0.6175 (0.9457)  div_loss: -5.2424 (-5.1895)  acc1: 0.0000 (52.3256)  time: 0.0166  data: 0.0018  max mem: 242
Test Total time: 0:00:03 (0.0422 s / it)
* Acc@1 52.326 loss 0.946 auroc 0.747 f1_score 0.523
Epoch: [32]  [  0/389]  eta: 0:11:56  lr: 0.000029  sub_loss: 1.1796 (1.1796)  diff_loss: 0.0088 (0.0088)  slide_loss: 0.8645 (0.8645)  time: 1.8421  data: 1.7944  max mem: 242
Epoch: [32]  [100/389]  eta: 0:00:16  lr: 0.000028  sub_loss: 0.2796 (0.4873)  diff_loss: 0.0105 (0.0164)  slide_loss: 0.1870 (0.3538)  time: 0.0401  data: 0.0020  max mem: 242
Epoch: [32]  [200/389]  eta: 0:00:09  lr: 0.000027  sub_loss: 0.1840 (0.5536)  diff_loss: 0.0137 (0.0152)  slide_loss: 0.0513 (0.4328)  time: 0.0352  data: 0.0020  max mem: 242
Epoch: [32]  [300/389]  eta: 0:00:04  lr: 0.000027  sub_loss: 0.1843 (0.5358)  diff_loss: 0.0103 (0.0147)  slide_loss: 0.0630 (0.4087)  time: 0.0402  data: 0.0027  max mem: 242
Epoch: [32]  [388/389]  eta: 0:00:00  lr: 0.000026  sub_loss: 0.3108 (0.5420)  diff_loss: 0.0127 (0.0155)  slide_loss: 0.1077 (0.4138)  time: 0.0283  data: 0.0013  max mem: 242
Epoch: [32] Total time: 0:00:16 (0.0434 s / it)
Val  [ 0/62]  eta: 0:01:40  loss: 0.9136 (0.9136)  div_loss: -4.2860 (-4.2860)  acc1: 0.0000 (0.0000)  time: 1.6183  data: 1.6031  max mem: 242
Val  [61/62]  eta: 0:00:00  loss: 0.1553 (0.9037)  div_loss: -4.9749 (-5.2315)  acc1: 100.0000 (64.5161)  time: 0.0147  data: 0.0013  max mem: 242
Val Total time: 0:00:03 (0.0535 s / it)
* Acc@1 64.516 loss 0.904 auroc 0.779 f1_score 0.645
Test  [ 0/86]  eta: 0:03:36  loss: 2.6113 (2.6113)  div_loss: -5.1077 (-5.1077)  acc1: 0.0000 (0.0000)  time: 2.5219  data: 2.4918  max mem: 242
Test  [85/86]  eta: 0:00:00  loss: 0.4957 (1.0176)  div_loss: -5.1490 (-5.1746)  acc1: 0.0000 (54.6512)  time: 0.0152  data: 0.0015  max mem: 242
Test Total time: 0:00:04 (0.0516 s / it)
* Acc@1 54.651 loss 1.018 auroc 0.748 f1_score 0.547
Epoch: [33]  [  0/389]  eta: 0:12:43  lr: 0.000026  sub_loss: 0.0624 (0.0624)  diff_loss: 0.0067 (0.0067)  slide_loss: 0.0142 (0.0142)  time: 1.9617  data: 1.9108  max mem: 242
Epoch: [33]  [100/389]  eta: 0:00:17  lr: 0.000025  sub_loss: 0.3043 (0.5598)  diff_loss: 0.0109 (0.0189)  slide_loss: 0.1848 (0.4039)  time: 0.0363  data: 0.0016  max mem: 242
Epoch: [33]  [200/389]  eta: 0:00:09  lr: 0.000025  sub_loss: 0.2246 (0.5669)  diff_loss: 0.0085 (0.0175)  slide_loss: 0.1089 (0.4307)  time: 0.0353  data: 0.0016  max mem: 242
Epoch: [33]  [300/389]  eta: 0:00:03  lr: 0.000024  sub_loss: 0.2759 (0.5611)  diff_loss: 0.0127 (0.0164)  slide_loss: 0.1197 (0.4370)  time: 0.0343  data: 0.0021  max mem: 242
Epoch: [33]  [388/389]  eta: 0:00:00  lr: 0.000023  sub_loss: 0.3603 (0.5405)  diff_loss: 0.0085 (0.0155)  slide_loss: 0.1280 (0.4042)  time: 0.0352  data: 0.0020  max mem: 242
Epoch: [33] Total time: 0:00:17 (0.0439 s / it)
Val  [ 0/62]  eta: 0:02:01  loss: 0.7089 (0.7089)  div_loss: -4.3413 (-4.3413)  acc1: 100.0000 (100.0000)  time: 1.9605  data: 1.9457  max mem: 242
Val  [61/62]  eta: 0:00:00  loss: 0.1175 (0.8948)  div_loss: -4.9881 (-5.2735)  acc1: 100.0000 (67.7419)  time: 0.0129  data: 0.0013  max mem: 242
Val Total time: 0:00:03 (0.0573 s / it)
* Acc@1 67.742 loss 0.895 auroc 0.783 f1_score 0.677
Test  [ 0/86]  eta: 0:02:36  loss: 2.6611 (2.6611)  div_loss: -5.0932 (-5.0932)  acc1: 0.0000 (0.0000)  time: 1.8146  data: 1.7822  max mem: 242
Test  [85/86]  eta: 0:00:00  loss: 0.3195 (1.0100)  div_loss: -5.1522 (-5.2199)  acc1: 0.0000 (56.9767)  time: 0.0213  data: 0.0025  max mem: 242
Test Total time: 0:00:04 (0.0475 s / it)
* Acc@1 56.977 loss 1.010 auroc 0.749 f1_score 0.570
Epoch: [34]  [  0/389]  eta: 0:13:23  lr: 0.000023  sub_loss: 0.1553 (0.1553)  diff_loss: 0.0415 (0.0415)  slide_loss: 0.0511 (0.0511)  time: 2.0665  data: 2.0182  max mem: 242
Epoch: [34]  [100/389]  eta: 0:00:18  lr: 0.000023  sub_loss: 0.1475 (0.4434)  diff_loss: 0.0108 (0.0204)  slide_loss: 0.0507 (0.3271)  time: 0.0420  data: 0.0021  max mem: 242
Epoch: [34]  [200/389]  eta: 0:00:09  lr: 0.000022  sub_loss: 0.2720 (0.4422)  diff_loss: 0.0123 (0.0185)  slide_loss: 0.0652 (0.3096)  time: 0.0359  data: 0.0016  max mem: 242
Epoch: [34]  [300/389]  eta: 0:00:03  lr: 0.000021  sub_loss: 0.4741 (0.5166)  diff_loss: 0.0097 (0.0174)  slide_loss: 0.1520 (0.3871)  time: 0.0426  data: 0.0018  max mem: 242
Epoch: [34]  [388/389]  eta: 0:00:00  lr: 0.000021  sub_loss: 0.2745 (0.5350)  diff_loss: 0.0112 (0.0170)  slide_loss: 0.1119 (0.3921)  time: 0.0321  data: 0.0016  max mem: 242
Epoch: [34] Total time: 0:00:16 (0.0428 s / it)
Val  [ 0/62]  eta: 0:02:01  loss: 0.7618 (0.7618)  div_loss: -4.2975 (-4.2975)  acc1: 100.0000 (100.0000)  time: 1.9651  data: 1.9491  max mem: 242
Val  [61/62]  eta: 0:00:00  loss: 0.1511 (0.8227)  div_loss: -4.9836 (-5.2376)  acc1: 100.0000 (66.1290)  time: 0.0169  data: 0.0015  max mem: 242
Val Total time: 0:00:03 (0.0613 s / it)
* Acc@1 66.129 loss 0.823 auroc 0.785 f1_score 0.661
Test  [ 0/86]  eta: 0:03:15  loss: 1.9851 (1.9851)  div_loss: -5.1331 (-5.1331)  acc1: 0.0000 (0.0000)  time: 2.2691  data: 2.2452  max mem: 242
Test  [85/86]  eta: 0:00:00  loss: 0.5263 (0.9561)  div_loss: -5.1853 (-5.1865)  acc1: 0.0000 (54.6512)  time: 0.0147  data: 0.0014  max mem: 242
Test Total time: 0:00:04 (0.0478 s / it)
* Acc@1 54.651 loss 0.956 auroc 0.745 f1_score 0.547
Epoch: [35]  [  0/389]  eta: 0:12:09  lr: 0.000021  sub_loss: 0.0644 (0.0644)  diff_loss: 0.0157 (0.0157)  slide_loss: 0.0400 (0.0400)  time: 1.8757  data: 1.8377  max mem: 242
Epoch: [35]  [100/389]  eta: 0:00:13  lr: 0.000020  sub_loss: 0.2662 (0.5158)  diff_loss: 0.0114 (0.0204)  slide_loss: 0.0876 (0.3883)  time: 0.0271  data: 0.0014  max mem: 242
Epoch: [35]  [200/389]  eta: 0:00:07  lr: 0.000019  sub_loss: 0.1948 (0.4925)  diff_loss: 0.0104 (0.0176)  slide_loss: 0.0421 (0.3621)  time: 0.0276  data: 0.0015  max mem: 242
Epoch: [35]  [300/389]  eta: 0:00:03  lr: 0.000019  sub_loss: 0.2451 (0.5227)  diff_loss: 0.0087 (0.0161)  slide_loss: 0.1566 (0.3944)  time: 0.0370  data: 0.0019  max mem: 242
Epoch: [35]  [388/389]  eta: 0:00:00  lr: 0.000018  sub_loss: 0.4056 (0.5336)  diff_loss: 0.0121 (0.0161)  slide_loss: 0.1722 (0.4054)  time: 0.0370  data: 0.0016  max mem: 242
Epoch: [35] Total time: 0:00:15 (0.0386 s / it)
Val  [ 0/62]  eta: 0:01:50  loss: 0.9219 (0.9219)  div_loss: -4.2314 (-4.2314)  acc1: 0.0000 (0.0000)  time: 1.7879  data: 1.7735  max mem: 242
Val  [61/62]  eta: 0:00:00  loss: 0.1391 (0.8554)  div_loss: -4.9933 (-5.2275)  acc1: 100.0000 (64.5161)  time: 0.0105  data: 0.0011  max mem: 242
Val Total time: 0:00:03 (0.0489 s / it)
* Acc@1 64.516 loss 0.855 auroc 0.785 f1_score 0.645
Test  [ 0/86]  eta: 0:02:09  loss: 2.4649 (2.4649)  div_loss: -4.9541 (-4.9541)  acc1: 0.0000 (0.0000)  time: 1.5085  data: 1.4858  max mem: 242
Test  [85/86]  eta: 0:00:00  loss: 0.4674 (0.9878)  div_loss: -5.1701 (-5.1580)  acc1: 0.0000 (55.8140)  time: 0.0093  data: 0.0011  max mem: 242
Test Total time: 0:00:03 (0.0353 s / it)
* Acc@1 55.814 loss 0.988 auroc 0.747 f1_score 0.558
Epoch: [36]  [  0/389]  eta: 0:09:06  lr: 0.000018  sub_loss: 0.5092 (0.5092)  diff_loss: 0.0051 (0.0051)  slide_loss: 0.5452 (0.5452)  time: 1.4052  data: 1.3461  max mem: 242
Epoch: [36]  [100/389]  eta: 0:00:12  lr: 0.000018  sub_loss: 0.3124 (0.4663)  diff_loss: 0.0158 (0.0192)  slide_loss: 0.0604 (0.3425)  time: 0.0262  data: 0.0012  max mem: 242
Epoch: [36]  [200/389]  eta: 0:00:06  lr: 0.000017  sub_loss: 0.3309 (0.5191)  diff_loss: 0.0096 (0.0186)  slide_loss: 0.0440 (0.3889)  time: 0.0315  data: 0.0014  max mem: 242
Epoch: [36]  [300/389]  eta: 0:00:03  lr: 0.000016  sub_loss: 0.3808 (0.5318)  diff_loss: 0.0084 (0.0163)  slide_loss: 0.1888 (0.3895)  time: 0.0289  data: 0.0013  max mem: 242
Epoch: [36]  [388/389]  eta: 0:00:00  lr: 0.000016  sub_loss: 0.1206 (0.5282)  diff_loss: 0.0105 (0.0158)  slide_loss: 0.0368 (0.3926)  time: 0.0223  data: 0.0012  max mem: 242
Epoch: [36] Total time: 0:00:12 (0.0331 s / it)
Val  [ 0/62]  eta: 0:01:39  loss: 0.9267 (0.9267)  div_loss: -4.2446 (-4.2446)  acc1: 0.0000 (0.0000)  time: 1.5976  data: 1.5730  max mem: 242
Val  [61/62]  eta: 0:00:00  loss: 0.1570 (0.8673)  div_loss: -4.9328 (-5.2009)  acc1: 100.0000 (64.5161)  time: 0.0098  data: 0.0012  max mem: 242
Val Total time: 0:00:02 (0.0426 s / it)
* Acc@1 64.516 loss 0.867 auroc 0.783 f1_score 0.645
Test  [ 0/86]  eta: 0:02:05  loss: 2.4764 (2.4764)  div_loss: -4.9738 (-4.9738)  acc1: 0.0000 (0.0000)  time: 1.4569  data: 1.4306  max mem: 242
Test  [85/86]  eta: 0:00:00  loss: 0.4890 (0.9885)  div_loss: -5.1251 (-5.1363)  acc1: 0.0000 (53.4884)  time: 0.0128  data: 0.0013  max mem: 242
Test Total time: 0:00:03 (0.0350 s / it)
* Acc@1 53.488 loss 0.989 auroc 0.747 f1_score 0.535
Epoch: [37]  [  0/389]  eta: 0:10:17  lr: 0.000016  sub_loss: 0.3481 (0.3481)  diff_loss: 0.0363 (0.0363)  slide_loss: 0.1346 (0.1346)  time: 1.5864  data: 1.5551  max mem: 242
Epoch: [37]  [100/389]  eta: 0:00:13  lr: 0.000015  sub_loss: 0.3550 (0.5376)  diff_loss: 0.0126 (0.0151)  slide_loss: 0.1139 (0.3933)  time: 0.0301  data: 0.0015  max mem: 242
Epoch: [37]  [200/389]  eta: 0:00:07  lr: 0.000015  sub_loss: 0.1661 (0.5160)  diff_loss: 0.0119 (0.0159)  slide_loss: 0.0561 (0.3735)  time: 0.0292  data: 0.0015  max mem: 242
Epoch: [37]  [300/389]  eta: 0:00:03  lr: 0.000014  sub_loss: 0.2919 (0.5375)  diff_loss: 0.0122 (0.0165)  slide_loss: 0.0870 (0.3997)  time: 0.0246  data: 0.0012  max mem: 242
Epoch: [37]  [388/389]  eta: 0:00:00  lr: 0.000014  sub_loss: 0.2598 (0.5258)  diff_loss: 0.0090 (0.0164)  slide_loss: 0.1366 (0.3896)  time: 0.0274  data: 0.0012  max mem: 242
Epoch: [37] Total time: 0:00:13 (0.0348 s / it)
Val  [ 0/62]  eta: 0:01:44  loss: 0.6706 (0.6706)  div_loss: -4.2759 (-4.2759)  acc1: 100.0000 (100.0000)  time: 1.6895  data: 1.6754  max mem: 242
Val  [61/62]  eta: 0:00:00  loss: 0.1197 (0.8229)  div_loss: -4.9963 (-5.2170)  acc1: 100.0000 (69.3548)  time: 0.0114  data: 0.0014  max mem: 242
Val Total time: 0:00:03 (0.0509 s / it)
* Acc@1 69.355 loss 0.823 auroc 0.789 f1_score 0.694
Test  [ 0/86]  eta: 0:02:04  loss: 2.1586 (2.1586)  div_loss: -5.0289 (-5.0289)  acc1: 0.0000 (0.0000)  time: 1.4512  data: 1.4244  max mem: 242
Test  [85/86]  eta: 0:00:00  loss: 0.5128 (0.9788)  div_loss: -5.1341 (-5.1527)  acc1: 0.0000 (56.9767)  time: 0.0094  data: 0.0012  max mem: 242
Test Total time: 0:00:02 (0.0340 s / it)
* Acc@1 56.977 loss 0.979 auroc 0.743 f1_score 0.570
Epoch: [38]  [  0/389]  eta: 0:09:56  lr: 0.000014  sub_loss: 0.2779 (0.2779)  diff_loss: 0.0061 (0.0061)  slide_loss: 0.0934 (0.0934)  time: 1.5328  data: 1.4918  max mem: 242
Epoch: [38]  [100/389]  eta: 0:00:12  lr: 0.000013  sub_loss: 0.4056 (0.5128)  diff_loss: 0.0105 (0.0157)  slide_loss: 0.1862 (0.3572)  time: 0.0257  data: 0.0013  max mem: 242
Epoch: [38]  [200/389]  eta: 0:00:06  lr: 0.000012  sub_loss: 0.3443 (0.5173)  diff_loss: 0.0074 (0.0147)  slide_loss: 0.1367 (0.3628)  time: 0.0277  data: 0.0013  max mem: 242
Epoch: [38]  [300/389]  eta: 0:00:02  lr: 0.000012  sub_loss: 0.2887 (0.5329)  diff_loss: 0.0105 (0.0148)  slide_loss: 0.1492 (0.3994)  time: 0.0294  data: 0.0013  max mem: 242
Epoch: [38]  [388/389]  eta: 0:00:00  lr: 0.000011  sub_loss: 0.1931 (0.5313)  diff_loss: 0.0131 (0.0152)  slide_loss: 0.0367 (0.3943)  time: 0.0245  data: 0.0013  max mem: 242
Epoch: [38] Total time: 0:00:12 (0.0312 s / it)
Val  [ 0/62]  eta: 0:01:27  loss: 0.7756 (0.7756)  div_loss: -4.2798 (-4.2798)  acc1: 100.0000 (100.0000)  time: 1.4193  data: 1.4063  max mem: 242
Val  [61/62]  eta: 0:00:00  loss: 0.1446 (0.8677)  div_loss: -4.9212 (-5.2055)  acc1: 100.0000 (67.7419)  time: 0.0119  data: 0.0012  max mem: 242
Val Total time: 0:00:02 (0.0404 s / it)
* Acc@1 67.742 loss 0.868 auroc 0.783 f1_score 0.677
Test  [ 0/86]  eta: 0:02:11  loss: 2.5430 (2.5430)  div_loss: -4.9699 (-4.9699)  acc1: 0.0000 (0.0000)  time: 1.5319  data: 1.5104  max mem: 242
Test  [85/86]  eta: 0:00:00  loss: 0.4438 (1.0021)  div_loss: -5.1354 (-5.1492)  acc1: 0.0000 (55.8140)  time: 0.0124  data: 0.0013  max mem: 242
Test Total time: 0:00:03 (0.0350 s / it)
* Acc@1 55.814 loss 1.002 auroc 0.746 f1_score 0.558
Epoch: [39]  [  0/389]  eta: 0:10:32  lr: 0.000011  sub_loss: 0.2776 (0.2776)  diff_loss: 0.0034 (0.0034)  slide_loss: 0.1483 (0.1483)  time: 1.6263  data: 1.5727  max mem: 242
Epoch: [39]  [100/389]  eta: 0:00:13  lr: 0.000011  sub_loss: 0.3570 (0.5747)  diff_loss: 0.0096 (0.0176)  slide_loss: 0.1630 (0.4093)  time: 0.0267  data: 0.0011  max mem: 242
Epoch: [39]  [200/389]  eta: 0:00:06  lr: 0.000010  sub_loss: 0.4092 (0.5051)  diff_loss: 0.0093 (0.0173)  slide_loss: 0.2010 (0.3590)  time: 0.0254  data: 0.0012  max mem: 242
Epoch: [39]  [300/389]  eta: 0:00:02  lr: 0.000010  sub_loss: 0.1682 (0.5217)  diff_loss: 0.0145 (0.0174)  slide_loss: 0.0975 (0.3900)  time: 0.0243  data: 0.0013  max mem: 242
Epoch: [39]  [388/389]  eta: 0:00:00  lr: 0.000010  sub_loss: 0.5353 (0.5246)  diff_loss: 0.0120 (0.0169)  slide_loss: 0.3652 (0.3892)  time: 0.0274  data: 0.0012  max mem: 242
Epoch: [39] Total time: 0:00:12 (0.0310 s / it)
Val  [ 0/62]  eta: 0:01:31  loss: 0.7858 (0.7858)  div_loss: -4.2746 (-4.2746)  acc1: 100.0000 (100.0000)  time: 1.4797  data: 1.4662  max mem: 242
Val  [61/62]  eta: 0:00:00  loss: 0.1323 (0.8701)  div_loss: -4.9206 (-5.1861)  acc1: 100.0000 (69.3548)  time: 0.0114  data: 0.0015  max mem: 242
Val Total time: 0:00:03 (0.0541 s / it)
* Acc@1 69.355 loss 0.870 auroc 0.785 f1_score 0.694
Test  [ 0/86]  eta: 0:02:04  loss: 2.6162 (2.6162)  div_loss: -4.9238 (-4.9238)  acc1: 0.0000 (0.0000)  time: 1.4492  data: 1.4275  max mem: 242
Test  [85/86]  eta: 0:00:00  loss: 0.4224 (1.0046)  div_loss: -5.1168 (-5.1213)  acc1: 0.0000 (56.9767)  time: 0.0099  data: 0.0012  max mem: 242
Test Total time: 0:00:02 (0.0344 s / it)
* Acc@1 56.977 loss 1.005 auroc 0.746 f1_score 0.570
Epoch: [40]  [  0/389]  eta: 0:09:37  lr: 0.000010  sub_loss: 0.3667 (0.3667)  diff_loss: 0.0045 (0.0045)  slide_loss: 0.2714 (0.2714)  time: 1.4856  data: 1.4360  max mem: 242
Epoch: [40]  [100/389]  eta: 0:00:11  lr: 0.000009  sub_loss: 0.2965 (0.5006)  diff_loss: 0.0090 (0.0153)  slide_loss: 0.1813 (0.3620)  time: 0.0270  data: 0.0012  max mem: 242
Epoch: [40]  [200/389]  eta: 0:00:06  lr: 0.000009  sub_loss: 0.1721 (0.5293)  diff_loss: 0.0106 (0.0153)  slide_loss: 0.0808 (0.3984)  time: 0.0241  data: 0.0013  max mem: 242
Epoch: [40]  [300/389]  eta: 0:00:02  lr: 0.000008  sub_loss: 0.3090 (0.4999)  diff_loss: 0.0101 (0.0156)  slide_loss: 0.1257 (0.3733)  time: 0.0261  data: 0.0013  max mem: 242
Epoch: [40]  [388/389]  eta: 0:00:00  lr: 0.000008  sub_loss: 0.3677 (0.5221)  diff_loss: 0.0102 (0.0157)  slide_loss: 0.0949 (0.3864)  time: 0.0225  data: 0.0011  max mem: 242
Epoch: [40] Total time: 0:00:11 (0.0304 s / it)
Val  [ 0/62]  eta: 0:01:30  loss: 0.6822 (0.6822)  div_loss: -4.3195 (-4.3195)  acc1: 100.0000 (100.0000)  time: 1.4583  data: 1.4467  max mem: 242
Val  [61/62]  eta: 0:00:00  loss: 0.1235 (0.8543)  div_loss: -4.9653 (-5.1945)  acc1: 100.0000 (69.3548)  time: 0.0113  data: 0.0012  max mem: 242
Val Total time: 0:00:02 (0.0401 s / it)
* Acc@1 69.355 loss 0.854 auroc 0.786 f1_score 0.694
Test  [ 0/86]  eta: 0:02:03  loss: 2.3104 (2.3104)  div_loss: -5.0117 (-5.0117)  acc1: 0.0000 (0.0000)  time: 1.4353  data: 1.4110  max mem: 242
Test  [85/86]  eta: 0:00:00  loss: 0.4284 (0.9846)  div_loss: -5.1286 (-5.1348)  acc1: 0.0000 (58.1395)  time: 0.0105  data: 0.0011  max mem: 242
Test Total time: 0:00:02 (0.0325 s / it)
* Acc@1 58.140 loss 0.985 auroc 0.744 f1_score 0.581
Epoch: [41]  [  0/389]  eta: 0:10:26  lr: 0.000008  sub_loss: 0.5385 (0.5385)  diff_loss: 0.0145 (0.0145)  slide_loss: 0.4497 (0.4497)  time: 1.6103  data: 1.5586  max mem: 242
Epoch: [41]  [100/389]  eta: 0:00:13  lr: 0.000007  sub_loss: 0.2497 (0.5019)  diff_loss: 0.0076 (0.0157)  slide_loss: 0.1244 (0.3513)  time: 0.0275  data: 0.0012  max mem: 242
Epoch: [41]  [200/389]  eta: 0:00:06  lr: 0.000007  sub_loss: 0.2968 (0.5472)  diff_loss: 0.0089 (0.0158)  slide_loss: 0.1324 (0.3863)  time: 0.0247  data: 0.0012  max mem: 242
Epoch: [41]  [300/389]  eta: 0:00:02  lr: 0.000007  sub_loss: 0.1126 (0.5203)  diff_loss: 0.0103 (0.0160)  slide_loss: 0.0475 (0.3782)  time: 0.0267  data: 0.0013  max mem: 242
Epoch: [41]  [388/389]  eta: 0:00:00  lr: 0.000006  sub_loss: 0.2677 (0.5144)  diff_loss: 0.0082 (0.0161)  slide_loss: 0.1875 (0.3744)  time: 0.0317  data: 0.0013  max mem: 242
Epoch: [41] Total time: 0:00:12 (0.0317 s / it)
Val  [ 0/62]  eta: 0:01:38  loss: 0.7661 (0.7661)  div_loss: -4.2985 (-4.2985)  acc1: 100.0000 (100.0000)  time: 1.5904  data: 1.5778  max mem: 242
Val  [61/62]  eta: 0:00:00  loss: 0.1311 (0.8634)  div_loss: -4.9423 (-5.1864)  acc1: 100.0000 (69.3548)  time: 0.0106  data: 0.0012  max mem: 242
Val Total time: 0:00:02 (0.0439 s / it)
* Acc@1 69.355 loss 0.863 auroc 0.784 f1_score 0.694
Test  [ 0/86]  eta: 0:02:04  loss: 2.4239 (2.4239)  div_loss: -4.9787 (-4.9787)  acc1: 0.0000 (0.0000)  time: 1.4522  data: 1.4314  max mem: 242
Test  [85/86]  eta: 0:00:00  loss: 0.4264 (0.9893)  div_loss: -5.1326 (-5.1221)  acc1: 0.0000 (56.9767)  time: 0.0104  data: 0.0013  max mem: 242
Test Total time: 0:00:02 (0.0328 s / it)
* Acc@1 56.977 loss 0.989 auroc 0.745 f1_score 0.570
Epoch: [42]  [  0/389]  eta: 0:09:45  lr: 0.000006  sub_loss: 0.1547 (0.1547)  diff_loss: 0.0138 (0.0138)  slide_loss: 0.0898 (0.0898)  time: 1.5064  data: 1.4652  max mem: 242
Epoch: [42]  [100/389]  eta: 0:00:11  lr: 0.000006  sub_loss: 0.3690 (0.6283)  diff_loss: 0.0102 (0.0156)  slide_loss: 0.1427 (0.4904)  time: 0.0235  data: 0.0012  max mem: 242
Epoch: [42]  [200/389]  eta: 0:00:06  lr: 0.000005  sub_loss: 0.6001 (0.5575)  diff_loss: 0.0062 (0.0152)  slide_loss: 0.2597 (0.4026)  time: 0.0265  data: 0.0013  max mem: 242
Epoch: [42]  [300/389]  eta: 0:00:02  lr: 0.000005  sub_loss: 0.2429 (0.5409)  diff_loss: 0.0109 (0.0158)  slide_loss: 0.0985 (0.3984)  time: 0.0213  data: 0.0012  max mem: 242
Epoch: [42]  [388/389]  eta: 0:00:00  lr: 0.000005  sub_loss: 0.1514 (0.5195)  diff_loss: 0.0087 (0.0160)  slide_loss: 0.0366 (0.3817)  time: 0.0283  data: 0.0013  max mem: 242
Epoch: [42] Total time: 0:00:11 (0.0305 s / it)
Val  [ 0/62]  eta: 0:01:28  loss: 0.7307 (0.7307)  div_loss: -4.2878 (-4.2878)  acc1: 100.0000 (100.0000)  time: 1.4283  data: 1.4194  max mem: 242
Val  [61/62]  eta: 0:00:00  loss: 0.1236 (0.8522)  div_loss: -4.9391 (-5.1838)  acc1: 100.0000 (69.3548)  time: 0.0114  data: 0.0014  max mem: 242
Val Total time: 0:00:02 (0.0401 s / it)
* Acc@1 69.355 loss 0.852 auroc 0.789 f1_score 0.694
Test  [ 0/86]  eta: 0:02:13  loss: 2.4190 (2.4190)  div_loss: -4.9490 (-4.9490)  acc1: 0.0000 (0.0000)  time: 1.5546  data: 1.5334  max mem: 242
Test  [85/86]  eta: 0:00:00  loss: 0.4065 (0.9908)  div_loss: -5.1195 (-5.1183)  acc1: 0.0000 (56.9767)  time: 0.0100  data: 0.0012  max mem: 242
Test Total time: 0:00:03 (0.0389 s / it)
* Acc@1 56.977 loss 0.991 auroc 0.744 f1_score 0.570
Epoch: [43]  [  0/389]  eta: 0:10:34  lr: 0.000005  sub_loss: 0.3880 (0.3880)  diff_loss: 0.0116 (0.0116)  slide_loss: 0.2014 (0.2014)  time: 1.6312  data: 1.5771  max mem: 242
Epoch: [43]  [100/389]  eta: 0:00:11  lr: 0.000004  sub_loss: 0.2816 (0.4357)  diff_loss: 0.0099 (0.0153)  slide_loss: 0.1022 (0.2955)  time: 0.0232  data: 0.0012  max mem: 242
Epoch: [43]  [200/389]  eta: 0:00:06  lr: 0.000004  sub_loss: 0.1388 (0.4954)  diff_loss: 0.0111 (0.0146)  slide_loss: 0.0511 (0.3668)  time: 0.0230  data: 0.0012  max mem: 242
Epoch: [43]  [300/389]  eta: 0:00:02  lr: 0.000004  sub_loss: 0.3806 (0.5106)  diff_loss: 0.0128 (0.0157)  slide_loss: 0.1154 (0.3725)  time: 0.0240  data: 0.0012  max mem: 242
Epoch: [43]  [388/389]  eta: 0:00:00  lr: 0.000004  sub_loss: 0.1353 (0.5167)  diff_loss: 0.0124 (0.0158)  slide_loss: 0.0306 (0.3772)  time: 0.0256  data: 0.0011  max mem: 242
Epoch: [43] Total time: 0:00:11 (0.0303 s / it)
Val  [ 0/62]  eta: 0:01:39  loss: 0.7477 (0.7477)  div_loss: -4.2824 (-4.2824)  acc1: 100.0000 (100.0000)  time: 1.6077  data: 1.5827  max mem: 242
Val  [61/62]  eta: 0:00:00  loss: 0.1251 (0.8598)  div_loss: -4.9372 (-5.1755)  acc1: 100.0000 (69.3548)  time: 0.0123  data: 0.0014  max mem: 242
Val Total time: 0:00:02 (0.0479 s / it)
* Acc@1 69.355 loss 0.860 auroc 0.786 f1_score 0.694
Test  [ 0/86]  eta: 0:02:11  loss: 2.5105 (2.5105)  div_loss: -4.9260 (-4.9260)  acc1: 0.0000 (0.0000)  time: 1.5273  data: 1.4994  max mem: 242
Test  [85/86]  eta: 0:00:00  loss: 0.4147 (0.9979)  div_loss: -5.1124 (-5.1074)  acc1: 0.0000 (56.9767)  time: 0.0099  data: 0.0013  max mem: 242
Test Total time: 0:00:02 (0.0347 s / it)
* Acc@1 56.977 loss 0.998 auroc 0.745 f1_score 0.570
Epoch: [44]  [  0/389]  eta: 0:09:29  lr: 0.000004  sub_loss: 1.4735 (1.4735)  diff_loss: 0.0052 (0.0052)  slide_loss: 1.7909 (1.7909)  time: 1.4651  data: 1.4106  max mem: 242
Epoch: [44]  [100/389]  eta: 0:00:11  lr: 0.000003  sub_loss: 0.2872 (0.4244)  diff_loss: 0.0107 (0.0163)  slide_loss: 0.1081 (0.3001)  time: 0.0277  data: 0.0013  max mem: 242
Epoch: [44]  [200/389]  eta: 0:00:06  lr: 0.000003  sub_loss: 0.4813 (0.4759)  diff_loss: 0.0100 (0.0169)  slide_loss: 0.2578 (0.3360)  time: 0.0294  data: 0.0013  max mem: 242
Epoch: [44]  [300/389]  eta: 0:00:02  lr: 0.000003  sub_loss: 0.4469 (0.5006)  diff_loss: 0.0104 (0.0162)  slide_loss: 0.2834 (0.3668)  time: 0.0270  data: 0.0012  max mem: 242
Epoch: [44]  [388/389]  eta: 0:00:00  lr: 0.000002  sub_loss: 0.2550 (0.5170)  diff_loss: 0.0128 (0.0164)  slide_loss: 0.1038 (0.3810)  time: 0.0237  data: 0.0013  max mem: 242
Epoch: [44] Total time: 0:00:11 (0.0301 s / it)
Val  [ 0/62]  eta: 0:01:28  loss: 0.7326 (0.7326)  div_loss: -4.2906 (-4.2906)  acc1: 100.0000 (100.0000)  time: 1.4318  data: 1.4198  max mem: 242
Val  [61/62]  eta: 0:00:00  loss: 0.1241 (0.8555)  div_loss: -4.9457 (-5.1799)  acc1: 100.0000 (69.3548)  time: 0.0119  data: 0.0012  max mem: 242
Val Total time: 0:00:02 (0.0406 s / it)
* Acc@1 69.355 loss 0.856 auroc 0.787 f1_score 0.694
Test  [ 0/86]  eta: 0:02:19  loss: 2.4183 (2.4183)  div_loss: -4.9558 (-4.9558)  acc1: 0.0000 (0.0000)  time: 1.6173  data: 1.5977  max mem: 242
Test  [85/86]  eta: 0:00:00  loss: 0.4170 (0.9928)  div_loss: -5.1273 (-5.1140)  acc1: 0.0000 (56.9767)  time: 0.0111  data: 0.0012  max mem: 242
Test Total time: 0:00:02 (0.0344 s / it)
* Acc@1 56.977 loss 0.993 auroc 0.745 f1_score 0.570
Epoch: [45]  [  0/389]  eta: 0:10:10  lr: 0.000002  sub_loss: 0.0524 (0.0524)  diff_loss: 0.0332 (0.0332)  slide_loss: 0.0238 (0.0238)  time: 1.5702  data: 1.5389  max mem: 242
Epoch: [45]  [100/389]  eta: 0:00:11  lr: 0.000002  sub_loss: 0.7018 (0.5178)  diff_loss: 0.0078 (0.0166)  slide_loss: 0.2613 (0.3307)  time: 0.0267  data: 0.0013  max mem: 242
Epoch: [45]  [200/389]  eta: 0:00:06  lr: 0.000002  sub_loss: 0.3802 (0.5205)  diff_loss: 0.0101 (0.0158)  slide_loss: 0.1353 (0.3528)  time: 0.0335  data: 0.0018  max mem: 242
Epoch: [45]  [300/389]  eta: 0:00:02  lr: 0.000002  sub_loss: 0.2823 (0.5506)  diff_loss: 0.0090 (0.0156)  slide_loss: 0.1272 (0.3979)  time: 0.0254  data: 0.0012  max mem: 242
Exception ignored in: <function _MultiProcessingDataLoaderIter.__del__ at 0x7f922f990280>
Traceback (most recent call last):
  File "/data/zyl/anaconda3/envs/wsi/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 1479, in __del__
    self._shutdown_workers()
  File "/data/zyl/anaconda3/envs/wsi/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 1443, in _shutdown_workers
    w.join(timeout=_utils.MP_STATUS_CHECK_INTERVAL)
  File "/data/zyl/anaconda3/envs/wsi/lib/python3.10/multiprocessing/process.py", line 149, in join
    res = self._popen.wait(timeout)
  File "/data/zyl/anaconda3/envs/wsi/lib/python3.10/multiprocessing/popen_fork.py", line 40, in wait
    if not wait([self.sentinel], timeout):
  File "/data/zyl/anaconda3/envs/wsi/lib/python3.10/multiprocessing/connection.py", line 931, in wait
    ready = selector.select(timeout)
  File "/data/zyl/anaconda3/envs/wsi/lib/python3.10/selectors.py", line 416, in select
    fd_event_list = self._selector.poll(timeout)
KeyboardInterrupt:
Traceback (most recent call last):
  File "/mnt/Xsky/zyl/code/ACMIL/Step3_WSI_classification_ACMIL.py", line 291, in <module>
    main()
  File "/mnt/Xsky/zyl/code/ACMIL/Step3_WSI_classification_ACMIL.py", line 139, in main
    train_one_epoch(model, criterion, train_loader, optimizer0, device, epoch, conf)
  File "/mnt/Xsky/zyl/code/ACMIL/Step3_WSI_classification_ACMIL.py", line 220, in train_one_epoch
    loss.backward()
  File "/data/zyl/anaconda3/envs/wsi/lib/python3.10/site-packages/torch/_tensor.py", line 487, in backward
    torch.autograd.backward(
  File "/data/zyl/anaconda3/envs/wsi/lib/python3.10/site-packages/torch/autograd/__init__.py", line 200, in backward
    Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
KeyboardInterrupt